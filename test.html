<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tourism.js 진짜 API 테스트</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .header {
            background: #007bff;
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            margin-bottom: 20px;
        }
        .test-section {
            background: white;
            margin: 20px 0;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 5px;
            cursor: pointer;
        }
        .btn:hover {
            background: #0056b3;
        }
        .result {
            background: #f8f9fa;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 15px;
            margin: 10px 0;
            font-family: monospace;
            font-size: 12px;
            max-height: 400px;
            overflow-y: auto;
            white-space: pre-wrap;
        }
        .success { border-color: #28a745; background: #d4edda; }
        .error { border-color: #dc3545; background: #f8d7da; }
        .loading { color: #007bff; font-weight: bold; }
        .input-group {
            margin: 10px 0;
        }
        .input-group label {
            display: inline-block;
            width: 100px;
            font-weight: bold;
        }
        .input-group input, .input-group select {
            padding: 5px;
            border: 1px solid #ddd;
            border-radius: 3px;
            width: 200px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>🔥 Tourism.js 실제 API 호출 테스트</h1>
        <p>진짜 한국관광공사 API를 호출해서 실제 데이터를 가져옵니다!</p>
    </div>

    <!-- API 상태 확인 -->
    <div class="test-section">
        <h2>🔍 API 상태 확인</h2>
        <button class="btn" onclick="checkHealth()">헬스체크</button>
        <button class="btn" onclick="checkSystemStatus()">시스템 상태</button>
        <div id="status-result" class="result" style="display:none;"></div>
    </div>

    <!-- 지역별 관광지 조회 -->
    <div class="test-section">
        <h2>🏛️ 지역별 관광지 조회 (진짜 API)</h2>
        
        <div class="input-group">
            <label>지역:</label>
            <select id="area-code">
                <option value="1">서울</option>
                <option value="6">부산</option>
                <option value="32">강원도</option>
                <option value="39">제주도</option>
            </select>
        </div>
        
        <div class="input-group">
            <label>타입:</label>
            <select id="content-type">
                <option value="12">관광지</option>
                <option value="14">문화시설</option>
                <option value="15">축제행사</option>
                <option value="32">숙박</option>
                <option value="39">음식점</option>
            </select>
        </div>
        
        <div class="input-group">
            <label>개수:</label>
            <select id="num-rows">
                <option value="5">5개</option>
                <option value="10" selected>10개</option>
                <option value="20">20개</option>
            </select>
        </div>
        
        <button class="btn" onclick="testAreaBasedList()">🔥 실제 API 호출!</button>
        <div id="area-result" class="result" style="display:none;"></div>
    </div>

    <!-- 키워드 검색 -->
    <div class="test-section">
        <h2>🔍 키워드 검색 (진짜 API)</h2>
        
        <div class="input-group">
            <label>키워드:</label>
            <input type="text" id="keyword" value="경복궁" placeholder="검색할 키워드">
        </div>
        
        <button class="btn" onclick="testSearchKeyword()">🔥 키워드 검색!</button>
        <div id="search-result" class="result" style="display:none;"></div>
    </div>

    <!-- 상세 정보 조회 -->
    <div class="test-section">
        <h2>📄 상세 정보 조회 (진짜 API)</h2>
        
        <div class="input-group">
            <label>콘텐츠ID:</label>
            <input type="text" id="content-id" value="126508" placeholder="콘텐츠 ID">
        </div>
        
        <button class="btn" onclick="testDetailCommon()">🔥 상세정보 가져오기!</button>
        <div id="detail-result" class="result" style="display:none;"></div>
    </div>

    <!-- 위치 기반 검색 -->
    <div class="test-section">
        <h2>📍 위치 기반 검색 (진짜 API)</h2>
        
        <div class="input-group">
            <label>위도:</label>
            <input type="text" id="map-y" value="37.5665" placeholder="위도">
        </div>
        
        <div class="input-group">
            <label>경도:</label>
            <input type="text" id="map-x" value="126.9780" placeholder="경도">
        </div>
        
        <div class="input-group">
            <label>반경(m):</label>
            <input type="text" id="radius" value="1000" placeholder="반경">
        </div>
        
        <button class="btn" onclick="testLocationBased()">🔥 위치 검색!</button>
        <div id="location-result" class="result" style="display:none;"></div>
    </div>

    <!-- 배치 요청 테스트 -->
    <div class="test-section">
        <h2>📦 배치 요청 (진짜 API)</h2>
        <p>여러 API를 한번에 호출합니다</p>
        
        <button class="btn" onclick="testBatchRequest()">🔥 배치 요청!</button>
        <div id="batch-result" class="result" style="display:none;"></div>
    </div>

    <div id="loading" class="loading" style="display:none;">⏳ 실제 API 호출 중...</div>

    <!-- tourism.js 로드 -->
    <script src="./tourism.js"></script>
    
    <script>
        let api = null;

        // 페이지 로드 시 tourism.js API 초기화
        window.addEventListener('load', async function() {
            console.log('🚀 Tourism.js 로딩 시작...');
            
            try {
                // 실제 tourism.js의 AllTourismAPI 클래스 사용
                api = new AllTourismAPI();
                console.log('✅ AllTourismAPI 인스턴스 생성 완료');
                console.log('📡 API 인스턴스:', api);
                
                // 초기 상태 확인
                await checkHealth();
                
            } catch (error) {
                console.error('❌ API 초기화 실패:', error);
                showResult('status-result', `API 초기화 실패: ${error.message}`, true);
            }
        });

        function showLoading() {
            document.getElementById('loading').style.display = 'block';
        }

        function hideLoading() {
            document.getElementById('loading').style.display = 'none';
        }

        function showResult(elementId, data, isError = false) {
            hideLoading();
            const element = document.getElementById(elementId);
            element.style.display = 'block';
            element.className = `result ${isError ? 'error' : 'success'}`;
            
            if (typeof data === 'object') {
                element.textContent = JSON.stringify(data, null, 2);
            } else {
                element.textContent = data;
            }
        }

        // 헬스체크
        async function checkHealth() {
            showLoading();
            try {
                console.log('🔍 헬스체크 시작...');
                
                // 실제 healthCheck 함수 호출
                const result = await healthCheck();
                
                console.log('✅ 헬스체크 완료:', result);
                showResult('status-result', result);
                
            } catch (error) {
                console.error('❌ 헬스체크 실패:', error);
                showResult('status-result', `헬스체크 실패: ${error.message}`, true);
            }
        }

        // 시스템 상태 확인
        async function checkSystemStatus() {
            showLoading();
            try {
                console.log('📊 시스템 상태 확인 시작...');
                
                if (!api) {
                    throw new Error('API 인스턴스가 없습니다');
                }
                
                // 실제 tourism.js의 getSystemStatus 메서드 호출
                const result = api.getSystemStatus();
                
                console.log('✅ 시스템 상태 확인 완료:', result);
                showResult('status-result', result);
                
            } catch (error) {
                console.error('❌ 시스템 상태 확인 실패:', error);
                showResult('status-result', `시스템 상태 확인 실패: ${error.message}`, true);
            }
        }

        // 지역별 관광지 조회
        async function testAreaBasedList() {
            showLoading();
            try {
                console.log('🏛️ 지역별 관광지 조회 시작...');
                
                if (!api) {
                    throw new Error('API 인스턴스가 없습니다');
                }
                
                const params = {
                    areaCode: document.getElementById('area-code').value,
                    contentTypeId: document.getElementById('content-type').value,
                    numOfRows: document.getElementById('num-rows').value,
                    pageNo: '1',
                    arrange: 'A'
                };
                
                console.log('📤 API 파라미터:', params);
                
                // 실제 tourism.js의 areaBasedList 메서드 호출
                const result = await api.areaBasedList(params);
                
                console.log('✅ 지역별 관광지 조회 완료:', result);
                showResult('area-result', result);
                
            } catch (error) {
                console.error('❌ 지역별 관광지 조회 실패:', error);
                showResult('area-result', `API 호출 실패: ${error.message}`, true);
            }
        }

        // 키워드 검색
        async function testSearchKeyword() {
            showLoading();
            try {
                console.log('🔍 키워드 검색 시작...');
                
                if (!api) {
                    throw new Error('API 인스턴스가 없습니다');
                }
                
                const keyword = document.getElementById('keyword').value.trim();
                if (!keyword) {
                    throw new Error('키워드를 입력해주세요');
                }
                
                const params = {
                    keyword: keyword,
                    numOfRows: '10',
                    pageNo: '1',
                    arrange: 'A'
                };
                
                console.log('📤 검색 파라미터:', params);
                
                // 실제 tourism.js의 searchKeyword 메서드 호출
                const result = await api.searchKeyword(params);
                
                console.log('✅ 키워드 검색 완료:', result);
                showResult('search-result', result);
                
            } catch (error) {
                console.error('❌ 키워드 검색 실패:', error);
                showResult('search-result', `검색 실패: ${error.message}`, true);
            }
        }

        // 상세 정보 조회
        async function testDetailCommon() {
            showLoading();
            try {
                console.log('📄 상세 정보 조회 시작...');
                
                if (!api) {
                    throw new Error('API 인스턴스가 없습니다');
                }
                
                const contentId = document.getElementById('content-id').value.trim();
                if (!contentId) {
                    throw new Error('콘텐츠 ID를 입력해주세요');
                }
                
                const params = {
                    contentId: contentId
                };
                
                console.log('📤 상세정보 파라미터:', params);
                
                // 실제 tourism.js의 detailCommon 메서드 호출
                const result = await api.detailCommon(params);
                
                console.log('✅ 상세 정보 조회 완료:', result);
                showResult('detail-result', result);
                
            } catch (error) {
                console.error('❌ 상세 정보 조회 실패:', error);
                showResult('detail-result', `상세정보 조회 실패: ${error.message}`, true);
            }
        }

        // 위치 기반 검색
        async function testLocationBased() {
            showLoading();
            try {
                console.log('📍 위치 기반 검색 시작...');
                
                if (!api) {
                    throw new Error('API 인스턴스가 없습니다');
                }
                
                const mapY = document.getElementById('map-y').value.trim();
                const mapX = document.getElementById('map-x').value.trim();
                const radius = document.getElementById('radius').value.trim();
                
                if (!mapY || !mapX) {
                    throw new Error('위도와 경도를 입력해주세요');
                }
                
                const params = {
                    mapX: mapX,
                    mapY: mapY,
                    radius: radius || '1000',
                    numOfRows: '10',
                    pageNo: '1',
                    arrange: 'A'
                };
                
                console.log('📤 위치 검색 파라미터:', params);
                
                // 실제 tourism.js의 locationBasedList 메서드 호출
                const result = await api.locationBasedList(params);
                
                console.log('✅ 위치 기반 검색 완료:', result);
                showResult('location-result', result);
                
            } catch (error) {
                console.error('❌ 위치 기반 검색 실패:', error);
                showResult('location-result', `위치 검색 실패: ${error.message}`, true);
            }
        }

        // 배치 요청
        async function testBatchRequest() {
            showLoading();
            try {
                console.log('📦 배치 요청 시작...');
                
                if (!api) {
                    throw new Error('API 인스턴스가 없습니다');
                }
                
                const operations = [
                    {
                        operation: 'areaBasedList',
                        params: {
                            areaCode: '1',
                            contentTypeId: '12',
                            numOfRows: '3'
                        }
                    },
                    {
                        operation: 'searchKeyword',
                        params: {
                            keyword: '경복궁',
                            numOfRows: '2'
                        }
                    },
                    {
                        operation: 'detailCommon',
                        params: {
                            contentId: '126508'
                        }
                    }
                ];
                
                console.log('📤 배치 요청 파라미터:', operations);
                
                // 실제 tourism.js의 batchRequest 메서드 호출
                const result = await api.batchRequest(operations);
                
                console.log('✅ 배치 요청 완료:', result);
                showResult('batch-result', result);
                
            } catch (error) {
                console.error('❌ 배치 요청 실패:', error);
                showResult('batch-result', `배치 요청 실패: ${error.message}`, true);
            }
        }
    </script>
</body>
</html>
