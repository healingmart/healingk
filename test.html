<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AllTourism v2.0 Enhanced í…ŒìŠ¤íŠ¸</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .header {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            margin-bottom: 30px;
            text-align: center;
        }
        
        .header h1 {
            margin: 0;
            color: #2c3e50;
            font-size: 2.5em;
            font-weight: 300;
        }
        
        .header p {
            margin: 10px 0 0 0;
            color: #7f8c8d;
            font-size: 1.2em;
        }
        
        .container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(600px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .test-section {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        
        .test-section h3 {
            color: #2c3e50;
            margin-top: 0;
            margin-bottom: 20px;
            font-size: 1.5em;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .button-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        .button-secondary {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }
        
        .button-success {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }
        
        .input-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        input, select {
            padding: 12px;
            border: 2px solid #ecf0f1;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s ease;
            flex: 1;
            min-width: 150px;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .result {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            padding: 20px;
            margin-top: 15px;
            max-height: 500px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            line-height: 1.4;
        }
        
        .loading { color: #f39c12; font-weight: bold; }
        .error { color: #e74c3c; font-weight: bold; }
        .success { color: #27ae60; font-weight: bold; }
        
        .stats {
            background: #e8f4f8;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid #3498db;
        }
        
        .badge {
            background: #3498db;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ›ï¸ AllTourism v2.0 Enhanced</h1>
        <p>ê¸°ì¡´ í˜¸í™˜ì„± + TourAPI 4.0 v4.3 ì™„ë²½ ì§€ì› <span class="badge">NEW</span></p>
    </div>
    
    <div class="container">
        <!-- ê¸°ì¡´ í˜¸í™˜ ê²€ìƒ‰ -->
        <div class="test-section">
            <h3>ğŸ”„ ê¸°ì¡´ í˜¸í™˜ ê²€ìƒ‰</h3>
            <div class="button-group">
                <button onclick="testLegacyAreaSearch()">ê¸°ì¡´ ì§€ì—­ê²€ìƒ‰</button>
                <button onclick="testLegacyLocationSearch()">ê¸°ì¡´ ìœ„ì¹˜ê²€ìƒ‰</button>
                <button onclick="testLegacyKeywordSearch()">ê¸°ì¡´ í‚¤ì›Œë“œê²€ìƒ‰</button>
            </div>
            <div class="stats">
                <strong>í˜¸í™˜ì„±:</strong> ê¸°ì¡´ alltourism v1.xì™€ 100% í˜¸í™˜
            </div>
            <div id="legacy-result" class="result"></div>
        </div>

        <!-- í–¥ìƒëœ ê²€ìƒ‰ -->
        <div class="test-section">
            <h3>ğŸš€ í–¥ìƒëœ ê²€ìƒ‰ (v2.0)</h3>
            <div class="input-group">
                <select id="enhancedOperation">
                    <option value="auto">ìë™ê°ì§€</option>
                    <option value="areaBasedList">ì§€ì—­ê¸°ë°˜</option>
                    <option value="locationBasedList">ìœ„ì¹˜ê¸°ë°˜</option>
                    <option value="searchKeyword">í‚¤ì›Œë“œ</option>
                    <option value="searchFestival">í–‰ì‚¬ê²€ìƒ‰</option>
                </select>
                <input type="text" id="enhancedParams" placeholder="areaCode=39&detailed=true" />
            </div>
            <div class="button-group">
                <button onclick="testEnhancedSearch()" class="button-secondary">í–¥ìƒëœ ê²€ìƒ‰</button>
                <button onclick="testAutoDetection()" class="button-success">ìë™ê°ì§€ í…ŒìŠ¤íŠ¸</button>
            </div>
            <div id="enhanced-result" class="result"></div>
        </div>

        <!-- ì‹ ê·œ v4.3 ê¸°ëŠ¥ -->
        <div class="test-section">
            <h3>âœ¨ v4.3 ì‹ ê·œ ê¸°ëŠ¥</h3>
            <div class="button-group">
                <button onclick="testLdongCode()">ë²•ì •ë™ì½”ë“œ</button>
                <button onclick="testLclsSystmCode()">ë¶„ë¥˜ì²´ê³„ì½”ë“œ</button>
                <button onclick="testPetTourInfo()">ë°˜ë ¤ë™ë¬¼ì •ë³´</button>
                <button onclick="testSyncList()">ë™ê¸°í™”ëª©ë¡</button>
            </div>
            <div class="stats">
                <strong>ìƒˆë¡œìš´ ê¸°ëŠ¥:</strong> ë²•ì •ë™/ë¶„ë¥˜ì²´ê³„ ì½”ë“œ, ë°˜ë ¤ë™ë¬¼ ì—¬í–‰ì •ë³´
            </div>
            <div id="v43-result" class="result"></div>
        </div>

        <!-- ì™„ë²½í•œ ìƒì„¸ì •ë³´ -->
        <div class="test-section">
            <h3>ğŸ“‹ ì™„ë²½í•œ ìƒì„¸ì •ë³´</h3>
            <div class="input-group">
                <input type="text" id="detailContentId" placeholder="ì½˜í…ì¸ ID (ì˜ˆ:125405)" value="125405" />
                <select id="detailType">
                    <option value="getAllData">ì „ì²´ì •ë³´</option>
                    <option value="detailCommon">ê³µí†µì •ë³´</option>
                    <option value="detailIntro">ì†Œê°œì •ë³´</option>
                    <option value="detailImage">ì´ë¯¸ì§€ì •ë³´</option>
                </select>
            </div>
            <div class="button-group">
                <button onclick="testDetailInfo()">ìƒì„¸ì •ë³´ ì¡°íšŒ</button>
                <button onclick="testAllDataWithImages()">ì™„ë²½í•œ ìƒì„¸ì •ë³´</button>
            </div>
            <div id="detail-result" class="result"></div>
        </div>

        <!-- ë‹¤ì¤‘ ì˜¤í¼ë ˆì´ì…˜ -->
        <div class="test-section">
            <h3>âš¡ ë‹¤ì¤‘ ì˜¤í¼ë ˆì´ì…˜</h3>
            <div class="input-group">
                <input type="text" id="multiOps" placeholder="areaBasedList,areaCode,categoryCode" value="areaBasedList,areaCode" />
                <input type="text" id="multiParams" placeholder="areaCode=39&numOfRows=3" value="areaCode=39&numOfRows=3" />
            </div>
            <div class="button-group">
                <button onclick="testMultiOperation()" class="button-secondary">ë‹¤ì¤‘ì‹¤í–‰</button>
                <button onclick="testCompleteExample()" class="button-success">ì™„ë²½í•œ ì˜ˆì œ</button>
            </div>
            <div class="stats">
                <strong>ê³ ê¸‰ ê¸°ëŠ¥:</strong> ì—¬ëŸ¬ ì˜¤í¼ë ˆì´ì…˜ì„ í•œ ë²ˆì— ì‹¤í–‰
            </div>
            <div id="multi-result" class="result"></div>
        </div>

        <!-- ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ -->
        <div class="test-section">
            <h3>ğŸ“Š ì„±ëŠ¥ & ë””ë²„ê·¸</h3>
            <div class="button-group">
                <button onclick="testPerformance()">ì„±ëŠ¥í…ŒìŠ¤íŠ¸</button>
                <button onclick="testDebugMode()">ë””ë²„ê·¸ëª¨ë“œ</button>
                <button onclick="testErrorHandling()">ì—ëŸ¬ì²˜ë¦¬</button>
                <button onclick="testBatchRequest()">ë°°ì¹˜ìš”ì²­</button>
            </div>
            <div id="performance-result" class="result"></div>
        </div>
    </div>

    <script>
        const API_BASE = '/api/alltourism'; // ê¸°ì¡´ê³¼ ë™ì¼í•œ ì—”ë“œí¬ì¸íŠ¸
        
        // ê¸°ì¡´ í˜¸í™˜ API í˜¸ì¶œ
        async function callLegacyAPI(params) {
            const url = `${API_BASE}?${new URLSearchParams(params)}`;
            console.log('ğŸ”— Legacy API URL:', url);
            
            try {
                const response = await fetch(url);
                return await response.json();
            } catch (error) {
                console.error('âŒ API ì˜¤ë¥˜:', error);
                return { error: error.message };
            }
        }

        // í–¥ìƒëœ API í˜¸ì¶œ
        async function callEnhancedAPI(params) {
            try {
                const response = await fetch(API_BASE, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(params)
                });
                return await response.json();
            } catch (error) {
                console.error('âŒ Enhanced API ì˜¤ë¥˜:', error);
                return { error: error.message };
            }
        }

        function displayResult(elementId, data) {
            const element = document.getElementById(elementId);
            
            // ì„±ëŠ¥ ì •ë³´ í‘œì‹œ
            if (data.metadata?.performance) {
                const stats = `
ğŸ“Š ì„±ëŠ¥ ì •ë³´:
- ì´ ì†Œìš”ì‹œê°„: ${data.metadata.performance.totalTime}ms
- ê²€ìƒ‰ì‹œê°„: ${data.metadata.performance.searchTime}ms
- ì•„ì´í…œ ìˆ˜: ${data.metadata.performance.itemCount}
- ìƒì„¸ì •ë³´ ìˆ˜: ${data.metadata.performance.detailedCount || 0}
- API ë²„ì „: ${data.metadata.apiVersion}
- í˜¸í™˜ì„±: ${data.metadata.compatibility}

`;
                element.innerHTML = stats + JSON.stringify(data, null, 2);
            } else {
                element.innerHTML = JSON.stringify(data, null, 2);
            }
            
            element.className = data.success ? 'result success' : 'result error';
        }

        function showLoading(elementId) {
            const element = document.getElementById(elementId);
            element.innerHTML = 'â³ ì²˜ë¦¬ ì¤‘...';
            element.className = 'result loading';
        }

        // ê¸°ì¡´ í˜¸í™˜ í…ŒìŠ¤íŠ¸ë“¤
        async function testLegacyAreaSearch() {
            showLoading('legacy-result');
            const result = await callLegacyAPI({
                areaCode: '39',
                numOfRows: '5',
                detailed: 'true'
            });
            displayResult('legacy-result', result);
        }

        async function testLegacyLocationSearch() {
            showLoading('legacy-result');
            const result = await callLegacyAPI({
                userLat: '33.5133',
                userLng: '126.5294',
                radius: '10',
                numOfRows: '5',
                sortBy: 'distance',
                sortOrder: 'asc'
            });
            displayResult('legacy-result', result);
        }

        async function testLegacyKeywordSearch() {
            showLoading('legacy-result');
            const result = await callLegacyAPI({
                keyword: 'í•œë¼ì‚°',
                numOfRows: '5',
                detailed: 'true',
                includeImages: 'true'
            });
            displayResult('legacy-result', result);
        }

        // í–¥ìƒëœ ê²€ìƒ‰ í…ŒìŠ¤íŠ¸ë“¤
        async function testEnhancedSearch() {
            showLoading('enhanced-result');
            const operation = document.getElementById('enhancedOperation').value;
            const paramsStr = document.getElementById('enhancedParams').value;
            
            const params = paramsStr.split('&').reduce((obj, param) => {
                const [key, value] = param.split('=');
                obj[key] = value;
                return obj;
            }, {});
            
            params.operation = operation;
            params.debug = 'true';
            
            const result = await callEnhancedAPI(params);
            displayResult('enhanced-result', result);
        }

        async function testAutoDetection() {
            showLoading('enhanced-result');
            
            // ë‹¤ì–‘í•œ íŒŒë¼ë¯¸í„° ì¡°í•©ìœ¼ë¡œ ìë™ê°ì§€ í…ŒìŠ¤íŠ¸
            const testCases = [
                { contentId: '125405', comment: 'ìƒì„¸ì •ë³´ ìë™ê°ì§€' },
                { keyword: 'ê²½ë³µê¶', comment: 'í‚¤ì›Œë“œ ìë™ê°ì§€' },
                { userLat: '37.5665', userLng: '126.9780', radius: '1000', comment: 'ìœ„ì¹˜ê¸°ë°˜ ìë™ê°ì§€' },
                { areaCode: '1', comment: 'ì§€ì—­ê¸°ë°˜ ìë™ê°ì§€' }
            ];
            
            const results = {};
            
            for (const testCase of testCases) {
                const { comment, ...params } = testCase;
                try {
                    const result = await callEnhancedAPI({ ...params, operation: 'auto', debug: 'true' });
                    results[comment] = {
                        detectedOperation: result.detectedOperation,
                        success: result.success,
                        itemCount: result.data?.items?.length || 0
                    };
                } catch (error) {
                    results[comment] = { error: error.message };
                }
            }
            
            displayResult('enhanced-result', { autoDetectionResults: results });
        }

        // v4.3 ì‹ ê·œ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸ë“¤
        async function testLdongCode() {
            showLoading('v43-result');
            const result = await callEnhancedAPI({
                operation: 'ldongCode',
                lDongRegnCd: '11',
                numOfRows: '10',
                debug: 'true'
            });
            displayResult('v43-result', result);
        }

        async function testLclsSystmCode() {
            showLoading('v43-result');
            const result = await callEnhancedAPI({
                operation: 'lclsSystmCode',
                lclsSystmListYn: 'Y',
                numOfRows: '10',
                debug: 'true'
            });
            displayResult('v43-result', result);
        }

        async function testPetTourInfo() {
            showLoading('v43-result');
            const result = await callEnhancedAPI({
                operation: 'detailPetTour',
                contentId: '125405',
                debug: 'true'
            });
            displayResult('v43-result', result);
        }

        async function testSyncList() {
            showLoading('v43-result');
            const result = await callEnhancedAPI({
                operation: 'areaBasedSyncList',
                showflag: '1',
                numOfRows: '5',
                debug: 'true'
            });
            displayResult('v43-result', result);
        }

        // ìƒì„¸ì •ë³´ í…ŒìŠ¤íŠ¸ë“¤
        async function testDetailInfo() {
            showLoading('detail-result');
            const contentId = document.getElementById('detailContentId').value;
            const detailType = document.getElementById('detailType').value;
            
            const result = await callEnhancedAPI({
                operation: detailType,
                contentId: contentId,
                contentTypeId: '12',
                includeImages: 'true',
                debug: 'true'
            });
            displayResult('detail-result', result);
        }

        async function testAllDataWithImages() {
            showLoading('detail-result');
            const contentId = document.getElementById('detailContentId').value;
            
            const result = await callEnhancedAPI({
                operation: 'getAllData',
                contentId: contentId,
                includeImages: 'true',
                petTourInfo: 'true',
                debug: 'true'
            });
            displayResult('detail-result', result);
        }

        // ë‹¤ì¤‘ ì˜¤í¼ë ˆì´ì…˜ í…ŒìŠ¤íŠ¸ë“¤
        async function testMultiOperation() {
            showLoading('multi-result');
            const operations = document.getElementById('multiOps').value;
            const paramsStr = document.getElementById('multiParams').value;
            
            const params = paramsStr.split('&').reduce((obj, param) => {
                const [key, value] = param.split('=');
                obj[key] = value;
                return obj;
            }, {});
            
            const result = await callEnhancedAPI({
                operation: 'multiSearch',
                operations: operations,
                ...params,
                debug: 'true'
            });
            displayResult('multi-result', result);
        }

        async function testCompleteExample() {
            showLoading('multi-result');
            
            // ì œì£¼ë„ ì™„ë²½í•œ ê´€ê´‘ì •ë³´ ì˜ˆì œ
            const result = await callEnhancedAPI({
                operation: 'auto',
                areaCode: '39',
                userLat: '33.5133',
                userLng: '126.5294',
                radius: '20',
                detailed: 'true',
                includeImages: 'true',
                numOfRows: '5',
                sortBy: 'distance',
                sortOrder: 'asc',
                debug: 'true'
            });
            displayResult('multi-result', result);
        }

        // ì„±ëŠ¥ & ë””ë²„ê·¸ í…ŒìŠ¤íŠ¸ë“¤
        async function testPerformance() {
            showLoading('performance-result');
            
            const startTime = Date.now();
            const results = [];
            
            // ì—¬ëŸ¬ ìš”ì²­ì„ ë™ì‹œì— ì‹¤í–‰
            const promises = [
                callEnhancedAPI({ operation: 'areaBasedList', areaCode: '1', numOfRows: '3' }),
                callEnhancedAPI({ operation: 'areaCode', numOfRows: '17' }),
                callEnhancedAPI({ operation: 'categoryCode', contentTypeId: '12', numOfRows: '5' })
            ];
            
            try {
                const parallelResults = await Promise.all(promises);
                const totalTime = Date.now() - startTime;
                
                displayResult('performance-result', {
                    performanceTest: {
                        totalTime: totalTime,
                        requestCount: promises.length,
                        averageTime: totalTime / promises.length,
                        results: parallelResults.map(r => ({
                            success: r.success,
                            itemCount: r.data?.items?.length || r.data?.length || 0,
                            responseTime: r.metadata?.performance?.totalTime
                        }))
                    }
                });
            } catch (error) {
                displayResult('performance-result', { error: error.message });
            }
        }

        async function testDebugMode() {
            showLoading('performance-result');
            const result = await callEnhancedAPI({
                operation: 'searchKeyword',
                keyword: 'ì œì£¼',
                areaCode: '39',
                numOfRows: '3',
                detailed: 'true',
                debug: 'true'
            });
            displayResult('performance-result', result);
        }

        async function testErrorHandling() {
            showLoading('performance-result');
            
            // ì˜ë„ì ìœ¼ë¡œ ì˜ëª»ëœ ìš”ì²­ë“¤
            const errorTests = [
                { operation: 'locationBasedList', comment: 'í•„ìˆ˜ íŒŒë¼ë¯¸í„° ëˆ„ë½' },
                { operation: 'detailCommon', comment: 'contentId ëˆ„ë½' },
                { operation: 'invalidOperation', comment: 'ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì˜¤í¼ë ˆì´ì…˜' }
            ];
            
            const results = {};
            for (const test of errorTests) {
                try {
                    const result = await callEnhancedAPI(test);
                    results[test.comment] = result;
                } catch (error) {
                    results[test.comment] = { error: error.message };
                }
            }
            
            displayResult('performance-result', { errorHandlingTests: results });
        }

        async function testBatchRequest() {
            showLoading('performance-result');
            
            // ë°°ì¹˜ ìš”ì²­ ì‹œë®¬ë ˆì´ì…˜
            const batchRequests = [
                { operation: 'areaBasedList', areaCode: '1', numOfRows: '2' },
                { operation: 'areaBasedList', areaCode: '6', numOfRows: '2' },
                { operation: 'areaBasedList', areaCode: '39', numOfRows: '2' }
            ];
            
            const startTime = Date.now();
            const results = await Promise.allSettled(
                batchRequests.map(req => callEnhancedAPI(req))
            );
            const totalTime = Date.now() - startTime;
            
            displayResult('performance-result', {
                batchResults: {
                    totalTime,
                    requestCount: batchRequests.length,
                    successCount: results.filter(r => r.status === 'fulfilled').length,
                    results: results.map((r, i) => ({
                        request: batchRequests[i],
                        status: r.status,
                        success: r.value?.success,
                        itemCount: r.value?.data?.items?.length || 0
                    }))
                }
            });
        }
    </script>
</body>
</html>
