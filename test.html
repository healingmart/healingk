<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í•œêµ­ê´€ê´‘ê³µì‚¬ API í´ë¼ì´ì–¸íŠ¸ í…ŒìŠ¤íŠ¸</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .content {
            padding: 30px;
        }

        .section {
            margin-bottom: 40px;
            padding: 25px;
            border: 2px solid #f0f0f0;
            border-radius: 10px;
            background: #fafafa;
        }

        .section h2 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.8em;
            border-bottom: 3px solid #4facfe;
            padding-bottom: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #555;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #4facfe;
            box-shadow: 0 0 0 3px rgba(79, 172, 254, 0.1);
        }

        .btn {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            margin-right: 10px;
            margin-bottom: 10px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(79, 172, 254, 0.3);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            color: #333;
        }

        .btn-danger {
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);
            color: #333;
        }

        .result {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
            max-height: 400px;
            overflow-y: auto;
        }

        .result pre {
            white-space: pre-wrap;
            word-wrap: break-word;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.5;
        }

        .status {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-weight: bold;
        }

        .status.success {
            background: #d4edda;
            color: #155724;
            border: 2px solid #c3e6cb;
        }

        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 2px solid #f5c6cb;
        }

        .status.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 2px solid #bee5eb;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .card {
            background: white;
            border: 2px solid #f0f0f0;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .card h3 {
            color: #4facfe;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #4facfe;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-value {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9em;
            opacity: 0.9;
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 10px;
            }
            
            .content {
                padding: 20px;
            }
            
            .header {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ‡°ğŸ‡· í•œêµ­ê´€ê´‘ê³µì‚¬ API í´ë¼ì´ì–¸íŠ¸</h1>
            <p>ì™„ë²½í•œ í…ŒìŠ¤íŠ¸ í™˜ê²½ - v2.1.0</p>
        </div>

        <div class="content">
            <!-- API í‚¤ ì„¤ì • -->
            <div class="section">
                <h2>ğŸ”‘ API í‚¤ ì„¤ì •</h2>
                <div class="form-group">
                    <label for="apiKey">í•œêµ­ê´€ê´‘ê³µì‚¬ API í‚¤:</label>
                    <input type="password" id="apiKey" placeholder="ì—¬ê¸°ì— API í‚¤ë¥¼ ì…ë ¥í•˜ì„¸ìš”">
                </div>
                <button class="btn" onclick="initializeAPI()">API ì´ˆê¸°í™”</button>
                <div id="apiStatus" class="status info" style="display:none;">
                    API í‚¤ë¥¼ ì…ë ¥í•˜ê³  ì´ˆê¸°í™” ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.
                </div>
            </div>

            <!-- ê¸°ë³¸ í…ŒìŠ¤íŠ¸ -->
            <div class="section">
                <h2>ğŸ§ª ê¸°ë³¸ API í…ŒìŠ¤íŠ¸</h2>
                
                <div class="grid">
                    <div class="card">
                        <h3>ì§€ì—­ë³„ ê´€ê´‘ì •ë³´</h3>
                        <div class="form-group">
                            <label>ì§€ì—­ ì½”ë“œ:</label>
                            <select id="areaCode">
                                <option value="1">ì„œìš¸</option>
                                <option value="6">ë¶€ì‚°</option>
                                <option value="39">ì œì£¼ë„</option>
                                <option value="31">ê²½ê¸°ë„</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>ì½˜í…ì¸  íƒ€ì…:</label>
                            <select id="contentType">
                                <option value="">ì „ì²´</option>
                                <option value="12">ê´€ê´‘ì§€</option>
                                <option value="14">ë¬¸í™”ì‹œì„¤</option>
                                <option value="15">ì¶•ì œê³µì—°í–‰ì‚¬</option>
                                <option value="32">ìˆ™ë°•</option>
                                <option value="39">ìŒì‹ì </option>
                            </select>
                        </div>
                        <button class="btn" onclick="testAreaBasedList()">ì§€ì—­ë³„ ì¡°íšŒ</button>
                    </div>

                    <div class="card">
                        <h3>í‚¤ì›Œë“œ ê²€ìƒ‰</h3>
                        <div class="form-group">
                            <label>ê²€ìƒ‰ í‚¤ì›Œë“œ:</label>
                            <input type="text" id="keyword" placeholder="ì˜ˆ: ê²½ë³µê¶, í•œì˜¥ë§ˆì„">
                        </div>
                        <div class="form-group">
                            <label>ê²€ìƒ‰ ê²°ê³¼ ìˆ˜:</label>
                            <select id="numOfRows">
                                <option value="10">10ê°œ</option>
                                <option value="20">20ê°œ</option>
                                <option value="50">50ê°œ</option>
                            </select>
                        </div>
                        <button class="btn" onclick="testSearchKeyword()">í‚¤ì›Œë“œ ê²€ìƒ‰</button>
                    </div>

                    <div class="card">
                        <h3>ìœ„ì¹˜ ê¸°ë°˜ ê²€ìƒ‰</h3>
                        <div class="form-group">
                            <label>ìœ„ë„:</label>
                            <input type="text" id="userLat" placeholder="37.5665" value="37.5665">
                        </div>
                        <div class="form-group">
                            <label>ê²½ë„:</label>
                            <input type="text" id="userLng" placeholder="126.9780" value="126.9780">
                        </div>
                        <div class="form-group">
                            <label>ë°˜ê²½(km):</label>
                            <input type="text" id="radius" placeholder="5" value="5">
                        </div>
                        <button class="btn" onclick="testLocationBased()">ìœ„ì¹˜ ê¸°ë°˜ ê²€ìƒ‰</button>
                    </div>

                    <div class="card">
                        <h3>ìƒì„¸ ì •ë³´</h3>
                        <div class="form-group">
                            <label>ì½˜í…ì¸  ID:</label>
                            <input type="text" id="contentId" placeholder="126508">
                        </div>
                        <button class="btn" onclick="testDetailCommon()">ìƒì„¸ ì •ë³´</button>
                        <button class="btn btn-secondary" onclick="testDetailImage()">ì´ë¯¸ì§€ ì •ë³´</button>
                    </div>
                </div>
            </div>

            <!-- ê³ ê¸‰ í…ŒìŠ¤íŠ¸ -->
            <div class="section">
                <h2>ğŸš€ ê³ ê¸‰ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸</h2>
                
                <div class="grid">
                    <div class="card">
                        <h3>ë°°ì¹˜ ìš”ì²­</h3>
                        <p>ì—¬ëŸ¬ APIë¥¼ ë™ì‹œì— í˜¸ì¶œí•©ë‹ˆë‹¤.</p>
                        <button class="btn" onclick="testBatchRequest()">ë°°ì¹˜ ìš”ì²­ ì‹¤í–‰</button>
                    </div>

                    <div class="card">
                        <h3>ì‹œìŠ¤í…œ ìƒíƒœ</h3>
                        <p>API í´ë¼ì´ì–¸íŠ¸ì˜ ìƒíƒœë¥¼ í™•ì¸í•©ë‹ˆë‹¤.</p>
                        <button class="btn btn-secondary" onclick="testSystemStatus()">ìƒíƒœ í™•ì¸</button>
                    </div>

                    <div class="card">
                        <h3>ìºì‹œ ê´€ë¦¬</h3>
                        <p>ìºì‹œë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤.</p>
                        <button class="btn btn-secondary" onclick="testCacheStats()">ìºì‹œ ìƒíƒœ</button>
                        <button class="btn btn-danger" onclick="testClearCache()">ìºì‹œ ì´ˆê¸°í™”</button>
                    </div>

                    <div class="card">
                        <h3>ì–¸ì–´ ì„¤ì •</h3>
                        <div class="form-group">
                            <select id="language">
                                <option value="ko">í•œêµ­ì–´</option>
                                <option value="en">English</option>
                                <option value="ja">æ—¥æœ¬èª</option>
                                <option value="zh">ä¸­æ–‡</option>
                            </select>
                        </div>
                        <button class="btn btn-secondary" onclick="testSetLanguage()">ì–¸ì–´ ë³€ê²½</button>
                    </div>
                </div>
            </div>

            <!-- ì„±ëŠ¥ í†µê³„ -->
            <div class="section">
                <h2>ğŸ“Š ì„±ëŠ¥ í†µê³„</h2>
                <div class="stats" id="performanceStats">
                    <div class="stat-card">
                        <div class="stat-value" id="totalRequests">0</div>
                        <div class="stat-label">ì´ ìš”ì²­ ìˆ˜</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="successRequests">0</div>
                        <div class="stat-label">ì„±ê³µí•œ ìš”ì²­</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="errorRequests">0</div>
                        <div class="stat-label">ì‹¤íŒ¨í•œ ìš”ì²­</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="avgResponseTime">0ms</div>
                        <div class="stat-label">í‰ê·  ì‘ë‹µì‹œê°„</div>
                    </div>
                </div>
            </div>

            <!-- ê²°ê³¼ í‘œì‹œ -->
            <div class="section">
                <h2>ğŸ“‹ ê²°ê³¼</h2>
                <div class="loading" id="loading">
                    <div class="spinner"></div>
                    <p>ìš”ì²­ ì²˜ë¦¬ ì¤‘...</p>
                </div>
                <div id="result" class="result">
                    <pre>ì—¬ê¸°ì— API ì‘ë‹µ ê²°ê³¼ê°€ í‘œì‹œë©ë‹ˆë‹¤.</pre>
                </div>
            </div>
        </div>
    </div>

    <!-- API ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë“œ -->
    <script src="../src/tourism-api.js"></script>

    <script>
        let api = null;
        let stats = {
            total: 0,
            success: 0,
            error: 0,
            responseTimes: []
        };

        // API ì´ˆê¸°í™”
        function initializeAPI() {
            const apiKey = document.getElementById('apiKey').value.trim();
            const statusDiv = document.getElementById('apiStatus');
            
            if (!apiKey) {
                showStatus('error', 'API í‚¤ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            try {
                api = new AllTourismAPI({
                    serviceKey: apiKey
                });
                
                showStatus('success', 'APIê°€ ì„±ê³µì ìœ¼ë¡œ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤!');
                statusDiv.style.display = 'block';
                statusDiv.className = 'status success';
                statusDiv.textContent = 'âœ… API ì¤€ë¹„ ì™„ë£Œ';
            } catch (error) {
                showStatus('error', 'API ì´ˆê¸°í™” ì‹¤íŒ¨: ' + error.message);
            }
        }

        // ìƒíƒœ í‘œì‹œ
        function showStatus(type, message) {
            const statusDiv = document.getElementById('apiStatus');
            statusDiv.style.display = 'block';
            statusDiv.className = `status ${type}`;
            statusDiv.textContent = message;
        }

        // ë¡œë”© í‘œì‹œ
        function showLoading(show = true) {
            document.getElementById('loading').style.display = show ? 'block' : 'none';
        }

        // ê²°ê³¼ í‘œì‹œ
        function showResult(data) {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = `<pre>${JSON.stringify(data, null, 2)}</pre>`;
            showLoading(false);
        }

        // í†µê³„ ì—…ë°ì´íŠ¸
        function updateStats(success, responseTime) {
            stats.total++;
            if (success) {
                stats.success++;
            } else {
                stats.error++;
            }
            
            if (responseTime) {
                stats.responseTimes.push(responseTime);
            }

            document.getElementById('totalRequests').textContent = stats.total;
            document.getElementById('successRequests').textContent = stats.success;
            document.getElementById('errorRequests').textContent = stats.error;
            
            if (stats.responseTimes.length > 0) {
                const avg = stats.responseTimes.reduce((a, b) => a + b, 0) / stats.responseTimes.length;
                document.getElementById('avgResponseTime').textContent = Math.round(avg) + 'ms';
            }
        }

        // API ìš”ì²­ ë˜í¼
        async function makeRequest(requestFunc, requestName) {
            if (!api) {
                showStatus('error', 'APIë¥¼ ë¨¼ì € ì´ˆê¸°í™”í•´ì£¼ì„¸ìš”.');
                return;
            }

            showLoading(true);
            const startTime = Date.now();

            try {
                const result = await requestFunc();
                const responseTime = Date.now() - startTime;
                
                updateStats(true, responseTime);
                showResult(result);
                showStatus('success', `${requestName} ì„±ê³µ! (${responseTime}ms)`);
                
                return result;
            } catch (error) {
                const responseTime = Date.now() - startTime;
                
                updateStats(false, responseTime);
                showResult({ error: error.message, stack: error.stack });
                showStatus('error', `${requestName} ì‹¤íŒ¨: ${error.message}`);
                
                throw error;
            }
        }

        // í…ŒìŠ¤íŠ¸ í•¨ìˆ˜ë“¤
        async function testAreaBasedList() {
            await makeRequest(async () => {
                return await api.areaBasedList({
                    areaCode: document.getElementById('areaCode').value,
                    contentTypeId: document.getElementById('contentType').value,
                    numOfRows: '10',
                    pageNo: '1'
                });
            }, 'ì§€ì—­ë³„ ê´€ê´‘ì •ë³´ ì¡°íšŒ');
        }

        async function testSearchKeyword() {
            const keyword = document.getElementById('keyword').value.trim();
            if (!keyword) {
                showStatus('error', 'ê²€ìƒ‰ í‚¤ì›Œë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            await makeRequest(async () => {
                return await api.searchKeyword({
                    keyword: keyword,
                    numOfRows: document.getElementById('numOfRows').value,
                    pageNo: '1'
                });
            }, 'í‚¤ì›Œë“œ ê²€ìƒ‰');
        }

        async function testLocationBased() {
            const userLat = document.getElementById('userLat').value;
            const userLng = document.getElementById('userLng').value;
            const radius = document.getElementById('radius').value;

            await makeRequest(async () => {
                return await api.searchKeyword({
                    keyword: 'ê´€ê´‘ì§€',
                    userLat: userLat,
                    userLng: userLng,
                    radius: radius,
                    numOfRows: '20'
                });
            }, 'ìœ„ì¹˜ ê¸°ë°˜ ê²€ìƒ‰');
        }

        async function testDetailCommon() {
            const contentId = document.getElementById('contentId').value.trim();
            if (!contentId) {
                showStatus('error', 'ì½˜í…ì¸  IDë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            await makeRequest(async () => {
                return await api.detailCommon({
                    contentId: contentId
                });
            }, 'ìƒì„¸ ì •ë³´ ì¡°íšŒ');
        }

        async function testDetailImage() {
            const contentId = document.getElementById('contentId').value.trim();
            if (!contentId) {
                showStatus('error', 'ì½˜í…ì¸  IDë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            await makeRequest(async () => {
                return await api.detailImage({
                    contentId: contentId
                });
            }, 'ì´ë¯¸ì§€ ì •ë³´ ì¡°íšŒ');
        }

        async function testBatchRequest() {
            await makeRequest(async () => {
                return await api.batchRequest([
                    {
                        operation: 'areaBasedList',
                        params: { areaCode: '1', numOfRows: '5' }
                    },
                    {
                        operation: 'searchKeyword',
                        params: { keyword: 'í•œì˜¥', numOfRows: '5' }
                    },
                    {
                        operation: 'areaCode',
                        params: { numOfRows: '10' }
                    }
                ]);
            }, 'ë°°ì¹˜ ìš”ì²­');
        }

        async function testSystemStatus() {
            await makeRequest(async () => {
                return api.getSystemStatus();
            }, 'ì‹œìŠ¤í…œ ìƒíƒœ ì¡°íšŒ');
        }

        async function testCacheStats() {
            if (!api) {
                showStatus('error', 'APIë¥¼ ë¨¼ì € ì´ˆê¸°í™”í•´ì£¼ì„¸ìš”.');
                return;
            }

            try {
                const cache = api.container.get('cache');
                const cacheStats = cache.getStats();
                showResult({
                    message: 'ìºì‹œ í†µê³„',
                    stats: cacheStats,
                    topItems: cache.getTopItems(5)
                });
                showStatus('info', 'ìºì‹œ í†µê³„ë¥¼ ì¡°íšŒí–ˆìŠµë‹ˆë‹¤.');
            } catch (error) {
                showStatus('error', 'ìºì‹œ í†µê³„ ì¡°íšŒ ì‹¤íŒ¨: ' + error.message);
            }
        }

        async function testClearCache() {
            await makeRequest(async () => {
                return api.clearCache();
            }, 'ìºì‹œ ì´ˆê¸°í™”');
        }

        async function testSetLanguage() {
            const language = document.getElementById('language').value;
            
            await makeRequest(async () => {
                return api.setLanguage(language);
            }, 'ì–¸ì–´ ì„¤ì • ë³€ê²½');
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            // ìƒ˜í”Œ API í‚¤ íŒíŠ¸
            const apiKeyInput = document.getElementById('apiKey');
            apiKeyInput.addEventListener('focus', function() {
                if (!this.value) {
                    showStatus('info', 'í•œêµ­ê´€ê´‘ê³µì‚¬ì—ì„œ ë°œê¸‰ë°›ì€ API í‚¤ë¥¼ ì…ë ¥í•˜ì„¸ìš”. (https://www.data.go.kr/)');
                }
            });

            // ì—”í„° í‚¤ë¡œ API ì´ˆê¸°í™”
            apiKeyInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    initializeAPI();
                }
            });

            // í‚¤
