<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tourism API Test - G3 Version</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; padding: 20px; background: #f8f9fa; }
        .container { max-width: 1200px; margin: 0 auto; }
        h1 { color: #0056b3; text-align: center; margin-bottom: 30px; }
        button { padding: 12px 24px; margin: 8px; background: #0056b3; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; transition: all 0.2s; }
        button:hover { background: #003d82; transform: translateY(-2px); box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
        button:disabled { background: #6c757d; cursor: not-allowed; transform: none; }
        .status { padding: 15px; margin: 15px 0; border-radius: 5px; font-weight: bold; }
        .loading { background: #fff3cd; color: #856404; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .category { margin: 20px 0; border: 1px solid #ddd; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
        .category-header { background: #0056b3; color: white; padding: 15px; font-weight: bold; display: flex; justify-content: space-between; }
        .items { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 15px; padding: 20px; }
        .item { border: 1px solid #eee; border-radius: 8px; overflow: hidden; background: white; transition: transform 0.2s; box-shadow: 0 1px 3px rgba(0,0,0,0.08); }
        .item:hover { transform: translateY(-3px); box-shadow: 0 4px 12px rgba(0,0,0,0.15); }
        .item img { width: 100%; height: 180px; object-fit: cover; }
        .item-content { padding: 15px; }
        .item-title { font-weight: bold; margin-bottom: 8px; color: #333; }
        .item-addr { color: #666; font-size: 0.9em; margin-bottom: 5px; }
        .item-distance { color: #0056b3; font-size: 0.9em; margin-bottom: 5px; font-weight: bold; }
        .item-id { color: #999; font-size: 0.8em; }
        .loading-spinner { display: inline-block; width: 16px; height: 16px; border: 2px solid #f3f3f3; border-top: 2px solid #0056b3; border-radius: 50%; animation: spin 1s linear infinite; margin-right: 8px; }
        .test-panel { background: #fff; border-radius: 8px; padding: 20px; margin: 20px 0; box-shadow: 0 2px 8px rgba(0,0,0,0.08); }
        .input-group { margin-bottom: 15px; }
        .input-group label { display: block; margin-bottom: 5px; font-weight: bold; }
        .input-group input, .input-group select { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; }
        .tabs { display: flex; margin-bottom: 20px; }
        .tab { padding: 12px 20px; border-bottom: 2px solid transparent; cursor: pointer; font-weight: bold; }
        .tab.active { border-color: #0056b3; color: #0056b3; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .json-response { background: #f8f9fa; border: 1px solid #ddd; border-radius: 4px; padding: 15px; margin: 10px 0; overflow: auto; max-height: 300px; font-family: monospace; }
        .item-detail { padding: 20px; background: white; border-radius: 8px; margin-bottom: 10px; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .metrics-table {width: 100%; border-collapse: collapse; margin: 20px 0;}
        .metrics-table th, .metrics-table td {border: 1px solid #ddd; padding: 8px; text-align: left;}
        .metrics-table th {background-color: #f2f2f2;}
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ›ï¸ í•œêµ­ê´€ê´‘ê³µì‚¬ API í…ŒìŠ¤íŠ¸ (G3 ë²„ì „)</h1>
        
        <div class="tabs">
            <div class="tab active" onclick="showTab('basic-tab')">ê¸°ë³¸ í…ŒìŠ¤íŠ¸</div>
            <div class="tab" onclick="showTab('detail-tab')">ìƒì„¸ì •ë³´ í…ŒìŠ¤íŠ¸</div>
            <div class="tab" onclick="showTab('location-tab')">ìœ„ì¹˜ê¸°ë°˜ í…ŒìŠ¤íŠ¸</div>
            <div class="tab" onclick="showTab('metrics-tab')">ë©”íŠ¸ë¦­ìŠ¤</div>
        </div>

        <div id="basic-tab" class="tab-content active">
            <div style="text-align: center; margin: 20px 0;">
                <button onclick="testHealthCheck()">â¤ï¸ í—¬ìŠ¤ì²´í¬</button>
                <button onclick="loadAll()">ğŸ›ï¸ ì „ì²´ ì¹´í…Œê³ ë¦¬ ë¡œë“œ (ê° 10ê°œ)</button>
                <button onclick="testSingle()">ğŸ§ª ë‹¨ì¼ í…ŒìŠ¤íŠ¸</button>
                <button onclick="clearResults()">ğŸ—‘ï¸ ì§€ìš°ê¸°</button>
            </div>
            
            <div id="status" style="display:none;"></div>
            <div id="results"></div>
        </div>

        <div id="detail-tab" class="tab-content">
            <div class="test-panel">
                <h3>ğŸ” ì½˜í…ì¸  ìƒì„¸ ì •ë³´ ì¡°íšŒ</h3>
                <div class="input-group">
                    <label for="contentId">ì½˜í…ì¸  ID:</label>
                    <input type="text" id="contentId" placeholder="ì˜ˆ: 125266">
                </div>
                <div class="input-group">
                    <label for="contentTypeId">ì½˜í…ì¸  íƒ€ì…:</label>
                    <select id="contentTypeId">
                        <option value="12">ê´€ê´‘ì§€</option>
                        <option value="14">ë¬¸í™”ì‹œì„¤</option>
                        <option value="15">ì¶•ì œ/ê³µì—°/í–‰ì‚¬</option>
                        <option value="25">ì—¬í–‰ì½”ìŠ¤</option>
                        <option value="28">ë ˆí¬ì¸ </option>
                        <option value="32">ìˆ™ë°•</option>
                        <option value="38">ì‡¼í•‘</option>
                        <option value="39">ìŒì‹ì </option>
                    </select>
                </div>
                <button onclick="getDetail()">ìƒì„¸ ì •ë³´ ì¡°íšŒ</button>
                <div id="detail-result"></div>
            </div>
        </div>

        <div id="location-tab" class="tab-content">
            <div class="test-panel">
                <h3>ğŸ“ ìœ„ì¹˜ ê¸°ë°˜ ê²€ìƒ‰</h3>
                <div class="input-group">
                    <label for="mapX">ê²½ë„(mapX):</label>
                    <input type="text" id="mapX" placeholder="ì˜ˆ: 126.981106" value="126.981106">
                </div>
                <div class="input-group">
                    <label for="mapY">ìœ„ë„(mapY):</label>
                    <input type="text" id="mapY" placeholder="ì˜ˆ: 37.568477" value="37.568477">
                </div>
                <div class="input-group">
                    <label for="radius">ë°˜ê²½(ë¯¸í„°):</label>
                    <input type="number" id="radius" placeholder="ì˜ˆ: 3000" value="3000">
                </div>
                <div class="input-group">
                    <label for="loc-content-type">ì½˜í…ì¸  íƒ€ì…:</label>
                    <select id="loc-content-type">
                        <option value="">ì „ì²´</option>
                        <option value="12">ê´€ê´‘ì§€</option>
                        <option value="14">ë¬¸í™”ì‹œì„¤</option>
                        <option value="15">ì¶•ì œ/ê³µì—°/í–‰ì‚¬</option>
                        <option value="25">ì—¬í–‰ì½”ìŠ¤</option>
                        <option value="28">ë ˆí¬ì¸ </option>
                        <option value="32">ìˆ™ë°•</option>
                        <option value="38">ì‡¼í•‘</option>
                        <option value="39">ìŒì‹ì </option>
                    </select>
                </div>
                <button onclick="searchByLocation()">ìœ„ì¹˜ ê¸°ë°˜ ê²€ìƒ‰</button>
                <div id="location-result"></div>
            </div>
        </div>

        <div id="metrics-tab" class="tab-content">
            <div class="test-panel">
                <h3>ğŸ“Š API ë©”íŠ¸ë¦­ìŠ¤ ì •ë³´</h3>
                <button onclick="getMetrics()">ë©”íŠ¸ë¦­ìŠ¤ ì¡°íšŒ</button>
                <div id="metrics-result"></div>
            </div>
        </div>
    </div>

    <script>
        // ê¸°ë³¸ API ê²½ë¡œ ì„¤ì •
        const API = '/api/tourism';
        
        // ì¹´í…Œê³ ë¦¬ ì •ì˜
        const categories = [
            {id:'12', name:'ê´€ê´‘ì§€', icon:'ğŸ›ï¸'},
            {id:'14', name:'ë¬¸í™”ì‹œì„¤', icon:'ğŸ­'},
            {id:'15', name:'ì¶•ì œ/ê³µì—°/í–‰ì‚¬', icon:'ğŸª'},
            {id:'25', name:'ì—¬í–‰ì½”ìŠ¤', icon:'ğŸ—ºï¸'},
            {id:'28', name:'ë ˆí¬ì¸ ', icon:'â›·ï¸'},
            {id:'32', name:'ìˆ™ë°•', icon:'ğŸ¨'},
            {id:'38', name:'ì‡¼í•‘', icon:'ğŸ›ï¸'},
            {id:'39', name:'ìŒì‹ì ', icon:'ğŸ½ï¸'}
        ];

        // ìƒíƒœ ë©”ì‹œì§€ í‘œì‹œ í•¨ìˆ˜
        function status(msg, type='loading') {
            const div = document.getElementById('status');
            div.innerHTML = msg;
            div.className = `status ${type}`;
            div.style.display = 'block';
        }

        // API í˜¸ì¶œ í•¨ìˆ˜ (GET ë°©ì‹)
        async function call(params) {
            const url = new URL(API, location.origin);
            Object.entries(params).forEach(([k,v]) => {
                if (v !== undefined && v !== null && v !== '') {
                    url.searchParams.set(k, v);
                }
            });
            
            try {
                const res = await fetch(url);
                const data = await res.json();
                
                if (!data.success) {
                    throw new Error(data.error?.message || `API Error: ${data.error?.code || 'Unknown error'}`);
                }
                
                return data;
            } catch (error) {
                console.error('API Error:', error);
                throw error;
            }
        }
        
        // í—¬ìŠ¤ì²´í¬ í•¨ìˆ˜
        async function testHealthCheck() {
            status('<span class="loading-spinner"></span>í—¬ìŠ¤ì²´í¬ ì¤‘...');
            try {
                const data = await call({ operation: 'healthCheck' });
                status(`âœ… ì—°ê²° ì„±ê³µ! ë²„ì „: ${data.data.version}, APIí‚¤: ${data.data.checks.apiKey ? 'ì„¤ì •ë¨' : 'ëˆ„ë½'}`, 'success');
            } catch (e) {
                status(`âŒ ì—°ê²° ì‹¤íŒ¨: ${e.message}`, 'error');
            }
        }

        // ë‹¨ì¼ í…ŒìŠ¤íŠ¸ í•¨ìˆ˜
        async function testSingle() {
            status('<span class="loading-spinner"></span>ë‹¨ì¼ í…ŒìŠ¤íŠ¸ ì¤‘...');
            try {
                const data = await call({ operation: 'areaBasedList', contentTypeId: '12', numOfRows: '5' });
                const items = extractItems(data);
                const totalCount = extractTotalCount(data);
                
                status(`âœ… ë‹¨ì¼ í…ŒìŠ¤íŠ¸ ì„±ê³µ! ${items.length}ê°œ ì•„ì´í…œ`, 'success');
                showCategory({id:'12', name:'ê´€ê´‘ì§€ í…ŒìŠ¤íŠ¸', icon:'ğŸ›ï¸'}, items, totalCount);
            } catch (e) {
                status(`âŒ ë‹¨ì¼ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨: ${e.message}`, 'error');
            }
        }
        
        // ì „ì²´ ì¹´í…Œê³ ë¦¬ ë¡œë“œ í•¨ìˆ˜
        async function loadAll() {
            document.getElementById('results').innerHTML = '';
            status('<span class="loading-spinner"></span>ëª¨ë“  ì¹´í…Œê³ ë¦¬ ë¡œë”© ì¤‘...');
            
            let total = 0;
            let success = 0;
            
            for(let i = 0; i < categories.length; i++) {
                const cat = categories[i];
                status(`<span class="loading-spinner"></span>${i+1}/${categories.length} ${cat.name} ë¡œë”© ì¤‘...`);
                
                try {
                    const data = await call({
                        operation: 'areaBasedList',
                        contentTypeId: cat.id,
                        numOfRows: '10'
                    });
                    
                    const items = extractItems(data);
                    const totalCount = extractTotalCount(data);
                    showCategory(cat, items, totalCount);
                    total += items.length;
                    success++;
                    
                    // ìš”ì²­ ê°„ê²© ì¡°ì ˆ
                    if(i < categories.length-1) await new Promise(r => setTimeout(r, 400));
                } catch(e) {
                    showError(cat, e.message);
                }
            }
            
            status(`âœ… ì™„ë£Œ! ${success}/${categories.length} ì¹´í…Œê³ ë¦¬ì—ì„œ ì´ ${total}ê°œ ë°ì´í„° ë¡œë“œ`, 'success');
        }
        
        // ìœ„ì¹˜ ê¸°ë°˜ ê²€ìƒ‰ í•¨ìˆ˜
        async function searchByLocation() {
            const locationResult = document.getElementById('location-result');
            locationResult.innerHTML = '<div class="status loading"><span class="loading-spinner"></span>ìœ„ì¹˜ ê¸°ë°˜ ê²€ìƒ‰ ì¤‘...</div>';
            
            try {
                const mapX = document.getElementById('mapX').value;
                const mapY = document.getElementById('mapY').value;
                const radius = document.getElementById('radius').value;
                const contentTypeId = document.getElementById('loc-content-type').value;
                
                const data = await call({
                    operation: 'locationBasedList',
                    mapX,
                    mapY,
                    radius,
                    contentTypeId,
                    numOfRows: '20',
                    arrange: 'E' // ê±°ë¦¬ìˆœ ì •ë ¬
                });
                
                const items = extractItems(data);
                
                if (items.length === 0) {
                    locationResult.innerHTML = '<div class="status error">ì¡°ê±´ì— ë§ëŠ” ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
                    return;
                }
                
                let html = '<div class="status success">âœ… ê²€ìƒ‰ ê²°ê³¼: ' + items.length + 'ê°œ í•­ëª©</div>';
                html += '<div class="items">';
                
                items.forEach(item => {
                    html += `
                        <div class="item">
                            <img src="${item.firstimage || 'https://via.placeholder.com/280x180?text=ì´ë¯¸ì§€+ì—†ìŒ'}" 
                                 onerror="this.src='https://via.placeholder.com/280x180?text=ì´ë¯¸ì§€+ì—†ìŒ'">
                            <div class="item-content">
                                <div class="item-title">${item.title || 'ì œëª©ì—†ìŒ'}</div>
                                <div class="item-addr">ğŸ“ ${item.addr1 || 'ì£¼ì†Œì—†ìŒ'}</div>
                                ${item.distance ? `<div class="item-distance">ğŸ§­ ${(item.distance/1000).toFixed(2)}km</div>` : ''}
                                <div class="item-id">ID: ${item.contentid}</div>
                            </div>
                        </div>
                    `;
                });
                
                html += '</div>';
                locationResult.innerHTML = html;
                
            } catch (e) {
                locationResult.innerHTML = `<div class="status error">âŒ ê²€ìƒ‰ ì‹¤íŒ¨: ${e.message}</div>`;
            }
        }
        
        // ìƒì„¸ ì •ë³´ ì¡°íšŒ í•¨ìˆ˜
        async function getDetail() {
            const detailResult = document.getElementById('detail-result');
            detailResult.innerHTML = '<div class="status loading"><span class="loading-spinner"></span>ìƒì„¸ ì •ë³´ ì¡°íšŒ ì¤‘...</div>';
            
            try {
                const contentId = document.getElementById('contentId').value;
                const contentTypeId = document.getElementById('contentTypeId').value;
                
                if (!contentId) {
                    detailResult.innerHTML = '<div class="status error">ì½˜í…ì¸  IDë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”</div>';
                    return;
                }
                
                // ê³µí†µ ì •ë³´ ì¡°íšŒ
                const commonData = await call({
                    operation: 'detailCommon',
                    contentId,
                    contentTypeId,
                    defaultYN: 'Y',
                    firstImageYN: 'Y',
                    areacodeYN: 'Y',
                    catcodeYN: 'Y',
                    addrinfoYN: 'Y',
                    mapinfoYN: 'Y',
                    overviewYN: 'Y'
                });
                
                // ì†Œê°œ ì •ë³´ ì¡°íšŒ
                const introData = await call({
                    operation: 'detailIntro',
                    contentId,
                    contentTypeId
                });
                
                const item = extractDetailItem(commonData);
                const introItem = extractDetailItem(introData);
                
                // ë‘ ì •ë³´ ë³‘í•©
                const combinedItem = {...item, ...introItem};
                
                let html = '<div class="item-detail">';
                
                // ì´ë¯¸ì§€ì™€ ì œëª©
                html += `
                    <div style="text-align: center; margin-bottom: 20px;">
                        <img src="${combinedItem.firstimage || 'https://via.placeholder.com/400x300?text=ì´ë¯¸ì§€+ì—†ìŒ'}" 
                            style="max-width: 100%; max-height: 400px; object-fit: contain;">
                        <h2 style="margin-top: 10px;">${combinedItem.title || 'ì œëª© ì—†ìŒ'}</h2>
                    </div>
                `;
                
                // ê¸°ë³¸ ì •ë³´ í‘œì‹œ
                html += '<div style="margin-bottom: 20px;">';
                html += `<p><strong>ì£¼ì†Œ:</strong> ${combinedItem.addr1 || ''} ${combinedItem.addr2 || ''}</p>`;
                
                if (combinedItem.tel) {
                    html += `<p><strong>ì „í™”ë²ˆí˜¸:</strong> ${combinedItem.tel}</p>`;
                }
                
                if (combinedItem.homepage) {
                    html += `<p><strong>í™ˆí˜ì´ì§€:</strong> <a href="${combinedItem.homepage}" target="_blank">${combinedItem.homepage}</a></p>`;
                }
                
                // ì¹´í…Œê³ ë¦¬ ì •ë³´
                if (combinedItem.contentTypeName) {
                    html += `<p><strong>ì¹´í…Œê³ ë¦¬:</strong> ${combinedItem.contentTypeName.ko} (${combinedItem.contentTypeName.en})</p>`;
                }
                
                // ì§€ì—­ ì •ë³´
                if (combinedItem.areaName) {
                    html += `<p><strong>ì§€ì—­:</strong> ${combinedItem.areaName.ko} (${combinedItem.areaName.en})</p>`;
                }
                
                html += '</div>';
                
                // ì†Œê°œ ì •ë³´
                if (combinedItem.overview) {
                    html += '<div style="margin-bottom: 20px;">';
                    html += '<h3>ì†Œê°œ</h3>';
                    html += `<div>${combinedItem.overview}</div>`;
                    html += '</div>';
                }
                
                // ì½˜í…ì¸  íƒ€ì…ë³„ ì¶”ê°€ ì •ë³´
                html += '<div style="margin-bottom: 20px;">';
                html += '<h3>ì¶”ê°€ ì •ë³´</h3>';
                
                // ì½˜í…ì¸  íƒ€ì…ë³„ íŠ¹ìˆ˜ í•„ë“œ í‘œì‹œ
                const specialFields = getSpecialFields(contentTypeId);
                for (const field of specialFields) {
                    if (combinedItem[field.key]) {
                        html += `<p><strong>${field.name}:</strong> ${combinedItem[field.key]}</p>`;
                    }
                }
                
                html += '</div>';
                
                // ì›ë³¸ JSON ë°ì´í„° í‘œì‹œ
                html += '<details style="margin-top: 20px;">';
                html += '<summary style="cursor: pointer; padding: 10px; background: #f0f0f0;">ì›ë³¸ JSON ë°ì´í„°</summary>';
                html += `<pre class="json-response">${JSON.stringify(combinedItem, null, 2)}</pre>`;
                html += '</details>';
                
                html += '</div>';
                
                detailResult.innerHTML = html;
                
            } catch (e) {
                detailResult.innerHTML = `<div class="status error">âŒ ì •ë³´ ì¡°íšŒ ì‹¤íŒ¨: ${e.message}</div>`;
            }
        }
        
        // ë©”íŠ¸ë¦­ìŠ¤ ì¡°íšŒ í•¨ìˆ˜
        async function getMetrics() {
            const metricsResult = document.getElementById('metrics-result');
            metricsResult.innerHTML = '<div class="status loading"><span class="loading-spinner"></span>ë©”íŠ¸ë¦­ìŠ¤ ì¡°íšŒ ì¤‘...</div>';
            
            try {
                const data = await call({
                    operation: 'metrics'
                });
                
                const metrics = data.data;
                
                let html = '<div class="status success">âœ… ë©”íŠ¸ë¦­ìŠ¤ ì¡°íšŒ ì„±ê³µ</div>';
                
                // ì„œë¹„ìŠ¤ ì •ë³´
                html += '<h3>ì„œë¹„ìŠ¤ ì •ë³´</h3>';
                html += '<table class="metrics-table">';
                html += '<tr><th>í•­ëª©</th><th>ê°’</th></tr>';
                html += `<tr><td>ì„œë¹„ìŠ¤ëª…</td><td>${metrics.service.name}</td></tr>`;
                html += `<tr><td>ë²„ì „</td><td>${metrics.service.version}</td></tr>`;
                html += `<tr><td>ì—…íƒ€ì„</td><td>${Math.floor(metrics.service.uptime / 1000 / 60)} ë¶„ ${Math.floor(metrics.service.uptime / 1000) % 60} ì´ˆ</td></tr>`;
                html += `<tr><td>í™˜ê²½</td><td>${metrics.service.environment}</td></tr>`;
                html += '</table>';
                
                // ìºì‹œ ì •ë³´
                html += '<h3>ìºì‹œ ì •ë³´</h3>';
                html += '<table class="metrics-table">';
                html += '<tr><th>í•­ëª©</th><th>ê°’</th></tr>';
                html += `<tr><td>ì ì¤‘ ìˆ˜</td><td>${metrics.cache.hits}</td></tr>`;
                html += `<tr><td>ë¯¸ìŠ¤ ìˆ˜</td><td>${metrics.cache.misses}</td></tr>`;
                html += `<tr><td>ìºì‹œ í¬ê¸°</td><td>${metrics.cache.size} í•­ëª©</td></tr>`;
                html += `<tr><td>ì ì¤‘ë¥ </td><td>${metrics.cache.hitRate.toFixed(2)}%</td></tr>`;
                html += `<tr><td>í™œì„±í™” ìƒíƒœ</td><td>${metrics.cache.enabled ? 'í™œì„±' : 'ë¹„í™œì„±'}</td></tr>`;
                html += '</table>';
                
                // ì†ë„ ì œí•œ ì •ë³´
                html += '<h3>ì†ë„ ì œí•œ ì •ë³´</h3>';
                html += '<table class="metrics-table">';
                html += '<tr><th>í•­ëª©</th><th>ê°’</th></tr>';
                html += `<tr><td>ì´ ìš”ì²­ ìˆ˜</td><td>${metrics.rateLimiter.totalRequests}</td></tr>`;
                html += `<tr><td>ì œí•œëœ ìš”ì²­ ìˆ˜</td><td>${metrics.rateLimiter.limitedRequests}</td></tr>`;
                html += `<tr><td>í™œì„± í´ë¼ì´ì–¸íŠ¸ ìˆ˜</td><td>${metrics.rateLimiter.activeClients}</td></tr>`;
                html += `<tr><td>í™œì„±í™” ìƒíƒœ</td><td>${metrics.rateLimiter.enabled ? 'í™œì„±' : 'ë¹„í™œì„±'}</td></tr>`;
                html += '</table>';
                
                // ë©”ëª¨ë¦¬ ì •ë³´ (ì œê³µëœ ê²½ìš°)
                if (metrics.memory) {
                    html += '<h3>ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰</h3>';
                    html += '<table class="metrics-table">';
                    html += '<tr><th>í•­ëª©</th><th>ê°’</th></tr>';
                    html += `<tr><td>ì‚¬ìš© í™ ë©”ëª¨ë¦¬</td><td>${(metrics.memory.heapUsed / 1024 / 1024).toFixed(2)} MB</td></tr>`;
                    html += `<tr><td>ì´ í™ ë©”ëª¨ë¦¬</td><td>${(metrics.memory.heapTotal / 1024 / 1024).toFixed(2)} MB</td></tr>`;
                    if (metrics.memory.external) {
                        html += `<tr><td>ì™¸ë¶€ ë©”ëª¨ë¦¬</td><td>${(metrics.memory.external / 1024 / 1024).toFixed(2)} MB</td></tr>`;
                    }
                    html += '</table>';
                }
                
                // ì›ë³¸ JSON ë°ì´í„° í‘œì‹œ
                html += '<details style="margin-top: 20px;">';
                html += '<summary style="cursor: pointer; padding: 10px; background: #f0f0f0;">ì›ë³¸ JSON ë°ì´í„°</summary>';
                html += `<pre class="json-response">${JSON.stringify(metrics, null, 2)}</pre>`;
                html += '</details>';
                
                metricsResult.innerHTML = html;
                
            } catch (e) {
                metricsResult.innerHTML = `<div class="status error">âŒ ë©”íŠ¸ë¦­ìŠ¤ ì¡°íšŒ ì‹¤íŒ¨: ${e.message}</div>`;
            }
        }
        
        // ì¹´í…Œê³ ë¦¬ë³„ íŠ¹ìˆ˜ í•„ë“œ ê°€ì ¸ì˜¤ê¸°
        function getSpecialFields(contentTypeId) {
            const fields = {
                '12': [ // ê´€ê´‘ì§€
                    {key: 'infocenter', name: 'ë¬¸ì˜ ë° ì•ˆë‚´'},
                    {key: 'restdate', name: 'ì‰¬ëŠ”ë‚ '},
                    {key: 'usetime', name: 'ì´ìš©ì‹œê°„'}
                ],
                '14': [ // ë¬¸í™”ì‹œì„¤
                    {key: 'infocenterculture', name: 'ë¬¸ì˜ ë° ì•ˆë‚´'},
                    {key: 'restdateculture', name: 'ì‰¬ëŠ”ë‚ '},
                    {key: 'usetimeculture', name: 'ì´ìš©ì‹œê°„'},
                    {key: 'parkingculture', name: 'ì£¼ì°¨ì‹œì„¤'}
                ],
                '15': [ // ì¶•ì œ/ê³µì—°/í–‰ì‚¬
                    {key: 'eventstartdate', name: 'í–‰ì‚¬ ì‹œì‘ì¼'},
                    {key: 'eventenddate', name: 'í–‰ì‚¬ ì¢…ë£Œì¼'},
                    {key: 'eventplace', name: 'í–‰ì‚¬ ì¥ì†Œ'},
                    {key: 'placeinfo', name: 'í–‰ì‚¬ì¥ ìœ„ì¹˜ì•ˆë‚´'}
                ],
                '25': [ // ì—¬í–‰ì½”ìŠ¤
                    {key: 'distance', name: 'ì½”ìŠ¤ ì´ ê±°ë¦¬'},
                    {key: 'taketime', name: 'ì†Œìš”ì‹œê°„'},
                    {key: 'theme', name: 'ì½”ìŠ¤ í…Œë§ˆ'}
                ],
                '28': [ // ë ˆí¬ì¸ 
                    {key: 'infocenterleports', name: 'ë¬¸ì˜ ë° ì•ˆë‚´'},
                    {key: 'restdateleports', name: 'ì‰¬ëŠ”ë‚ '},
                    {key: 'usetimeleports', name: 'ì´ìš©ì‹œê°„'}
                ],
                '32': [ // ìˆ™ë°•
                    {key: 'infocenterlodging', name: 'ë¬¸ì˜ ë° ì•ˆë‚´'},
                    {key: 'checkintime', name: 'ì²´í¬ì¸ ì‹œê°„'},
                    {key: 'checkouttime', name: 'ì²´í¬ì•„ì›ƒ ì‹œê°„'},
                    {key: 'roomtype', name: 'ê°ì‹¤ìœ í˜•'},
                    {key: 'reservationurl', name: 'ì˜ˆì•½ì•ˆë‚´ í™ˆí˜ì´ì§€'}
                ],
                '38': [ // ì‡¼í•‘
                    {key: 'infocentershopping', name: 'ë¬¸ì˜ ë° ì•ˆë‚´'},
                    {key: 'restdateshopping', name: 'ì‰¬ëŠ”ë‚ '},
                    {key: 'opentime', name: 'ì˜ì—…ì‹œê°„'},
                    {key: 'fairday', name: 'ì¥ì„œëŠ” ë‚ '}
                ],
                '39': [ // ìŒì‹ì 
                    {key: 'infocenterfood', name: 'ë¬¸ì˜ ë° ì•ˆë‚´'},
                    {key: 'restdatefood', name: 'ì‰¬ëŠ”ë‚ '},
                    {key: 'opentimefood', name: 'ì˜ì—…ì‹œê°„'},
                    {key: 'parkingfood', name: 'ì£¼ì°¨ì‹œì„¤'},
                    {key: 'firstmenu', name: 'ëŒ€í‘œ ë©”ë‰´'}
                ]
            };
            
            return fields[contentTypeId] || [];
        }

        // ì¹´í…Œê³ ë¦¬ í‘œì‹œ í•¨ìˆ˜ 
        function showCategory(cat, items, totalCount) {
            const div = document.createElement('div');
            div.className = 'category';
            div.innerHTML = `
                <div class="category-header">
                    <span>${cat.icon} ${cat.name}</span>
                    <span>${items.length}ê°œ / ì „ì²´ ${totalCount}ê°œ</span>
                </div>
                <div class="items">
                    ${items.map(item => `
                        <div class="item">
                            <img src="${item.firstimage || 'https://via.placeholder.com/280x180?text=ì´ë¯¸ì§€+ì—†ìŒ'}" 
                                 onerror="this.src='https://via.placeholder.com/280x180?text=ì´ë¯¸ì§€+ì—†ìŒ'">
                            <div class="item-content">
                                <div class="item-title">${item.title || 'ì œëª©ì—†ìŒ'}</div>
                                <div class="item-addr">ğŸ“ ${item.addr1 || 'ì£¼ì†Œì—†ìŒ'}</div>
                                ${item.distance ? `<div class="item-distance">ğŸ§­ ${(item.distance/1000).toFixed(2)}km</div>` : ''}
                                <div class="item-id">ID: ${item.contentid}</div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
            document.getElementById('results').appendChild(div);
        }

        // ì—ëŸ¬ í‘œì‹œ í•¨ìˆ˜
        function showError(cat, error) {
            const div = document.createElement('div');
            div.className = 'category';
            div.innerHTML = `
                <div class="category-header">
                    <span>${cat.icon} ${cat.name}</span>
                    <span style="color: #ffcdd2;">ì˜¤ë¥˜ ë°œìƒ</span>
                </div>
                <div style="padding:20px; color:#721c24; background:#f8d7da;">âŒ ${error}</div>
            `;
            document.getElementById('results').appendChild(div);
        }

        // ê²°ê³¼ ì§€ìš°ê¸° í•¨ìˆ˜
        function clearResults() {
            document.getElementById('results').innerHTML = '';
            document.getElementById('status').style.display = 'none';
        }
        
        // íƒ­ ì „í™˜ í•¨ìˆ˜
        function showTab(tabId) {
            // ëª¨ë“  íƒ­ ì»¨í…ì¸  ìˆ¨ê¸°ê¸°
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(tab => tab.classList.remove('active'));
            
            // ëª¨ë“  íƒ­ ë²„íŠ¼ ë¹„í™œì„±í™”
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            // ì„ íƒí•œ íƒ­ ì»¨í…ì¸ ì™€ ë²„íŠ¼ í™œì„±í™”
            document.getElementById(tabId).classList.add('active');
            document.querySelector(`.tab:nth-child(${Array.from(tabs).findIndex(tab => tab.getAttribute('onclick').includes(tabId)) + 1})`).classList.add('active');
        }
        
        // API ì‘ë‹µì—ì„œ í•­ëª© ì¶”ì¶œ (G3.txt í˜•ì‹ì— ë§ì¶¤)
        function extractItems(data) {
            // data -> data -> response -> body -> items -> item
            return (data?.data?.response?.body?.items?.item) || [];
        }
        
        // API ì‘ë‹µì—ì„œ ì „ì²´ ê°œìˆ˜ ì¶”ì¶œ
        function extractTotalCount(data) {
            // data -> data -> response -> body -> totalCount
            return data?.data?.response?.body?.totalCount || 0;
        }
        
        // ìƒì„¸ ì •ë³´ì—ì„œ í•­ëª© ì¶”ì¶œ
        function extractDetailItem(data) {
            const items = extractItems(data);
            // ë‹¨ì¼ í•­ëª© ë°˜í™˜
            return items.length > 0 ? items[0] : {};
        }

        // í˜ì´ì§€ ë¡œë“œì‹œ ìë™ í—¬ìŠ¤ì²´í¬
        window.onload = () => testHealthCheck();
    </script>
</body>
</html>
