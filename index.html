<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>대한민국 7대 관광지 소개</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f7f6;
            color: #333;
            line-height: 1.6;
        }
        header {
            background-color: #2c3e50;
            color: #ecf0f1;
            padding: 20px 0;
            text-align: center;
            border-bottom: 5px solid #3498db;
        }
        header h1 {
            margin: 0;
            font-size: 2.5em;
        }
        nav {
            text-align: center;
            margin: 20px 0;
        }
        nav button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            transition: background-color 0.3s ease;
        }
        nav button:hover {
            background-color: #2980b9;
        }
        .language-switcher {
            text-align: right;
            padding: 10px 20px;
        }
        .language-switcher button {
            background-color: #95a5a6;
            padding: 8px 15px;
            font-size: 0.9em;
        }
        .language-switcher button:hover {
            background-color: #7f8c8d;
        }
        .container {
            width: 90%;
            max-width: 1200px;
            margin: 20px auto;
            padding: 20px;
            background-color: #ffffff;
            box-shadow: 0 0 15px rgba(0,0,0,0.1);
            border-radius: 8px;
        }
        .spot-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        .spot-card {
            border: 1px solid #ddd;
            border-radius: 8px;
            overflow: hidden;
            background-color: #fff;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .spot-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0,0,0,0.1);
        }
        .spot-card img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-bottom: 1px solid #eee;
        }
        .spot-card-content {
            padding: 15px;
        }
        .spot-card h3 {
            margin-top: 0;
            color: #3498db;
            font-size: 1.5em;
        }
        .spot-card p {
            font-size: 0.95em;
            color: #555;
        }
        .spot-card .address {
            font-size: 0.85em;
            color: #777;
            margin-bottom: 10px;
        }
        .spot-card .tel {
            font-size: 0.85em;
            color: #777;
            margin-bottom: 10px;
        }
        .spot-card .homepage a {
            color: #e67e22;
            text-decoration: none;
        }
        .spot-card .homepage a:hover {
            text-decoration: underline;
        }
        .loader {
            text-align: center;
            padding: 50px;
            font-size: 1.5em;
            color: #7f8c8d;
        }
        footer {
            text-align: center;
            padding: 20px;
            margin-top: 30px;
            background-color: #34495e;
            color: #ecf0f1;
            font-size: 0.9em;
        }
    </style>
</head>
<body>

    <header>
        <h1 id="pageTitle">대한민국 7대 관광지</h1>
    </header>

    <div class="language-switcher">
        <button onclick="loadTouristSpots('ko')" id="langKoBtn">🇰🇷 한국어</button>
        <button onclick="loadTouristSpots('en')" id="langEnBtn">🇬🇧 English</button>
    </div>

    <div class="container">
        <p id="pageDescription" style="text-align: center; font-size: 1.1em; margin-bottom: 30px;">
            한국의 아름다운 7대 관광 명소를 소개합니다. 각 장소의 상세 정보를 확인해보세요.
        </p>
        <div id="spotGrid" class="spot-grid">
            <!-- 관광지 정보가 여기에 동적으로 추가됩니다 -->
        </div>
        <div id="loader" class="loader" style="display: none;">
            정보를 불러오는 중입니다...
        </div>
    </div>

    <footer>
        <p>&copy; 2025 HealingK Tour Information. All rights reserved.</p>
    </footer>

    <script>
        const API_ENDPOINT = 'https://healingk.vercel.app/api/tourism'; // Vercel 배포 URL
        const spotGrid = document.getElementById('spotGrid');
        const loader = document.getElementById('loader');
        const pageTitle = document.getElementById('pageTitle');
        const pageDescription = document.getElementById('pageDescription');

        // 임의로 선정한 7대 관광지 contentId (실제 서비스에서는 검색 등으로 동적 로드 권장)
        // 순서: 경복궁, 석굴암/불국사, 해인사 장경판전, 창덕궁, 수원화성, 제주 화산섬과 용암동굴, 남한산성 (유네스코 등재 기준 참고)
        const sevenWondersContentIds = [
            { id: '126508', nameKo: "경복궁", nameEn: "Gyeongbokgung Palace" }, // 경복궁
            { id: '126510', nameKo: "불국사", nameEn: "Bulguksa Temple" }, // 불국사
            { id: '126515', nameKo: "해인사", nameEn: "Haeinsa Temple" }, // 해인사 (장경판전)
            { id: '126509', nameKo: "창덕궁과 후원", nameEn: "Changdeokgung Palace and Huwon" }, // 창덕궁
            { id: '126512', nameKo: "수원화성", nameEn: "Suwon Hwaseong Fortress" }, // 수원화성
            { id: '788049', nameKo: "제주 화산섬과 용암동굴", nameEn: "Jeju Volcanic Island and Lava Tubes" }, // 제주 (성산일출봉 예시)
            { id: '128119', nameKo: "남한산성도립공원", nameEn: "Namhansanseong Provincial Park" }  // 남한산성
        ];

        let currentLang = 'ko'; // 기본 언어

        // API 호출 함수
        async function fetchSpotDetail(contentId, lang = 'ko') {
            const params = new URLSearchParams({
                operation: 'detailCommon', // 상세 정보 조회 오퍼레이션
                contentId: contentId,
                defaultYN: 'Y',
                firstImageYN: 'Y',
                areacodeYN: 'Y',
                addrinfoYN: 'Y',
                mapinfoYN: 'Y',
                overviewYN: 'Y',
                lang: lang // 언어 파라미터 추가
            });

            try {
                const response = await fetch(`${API_ENDPOINT}?${params.toString()}`, {
                    method: 'GET',
                    headers: {
                        'Accept-Language': lang // 헤더에도 언어 설정
                    }
                });
                if (!response.ok) {
                    const errorData = await response.json();
                    console.error(`Error fetching ${contentId} (${lang}):`, errorData);
                    throw new Error(`HTTP error ${response.status}: ${errorData.error?.message || 'Failed to fetch data'}`);
                }
                const data = await response.json();
                if (data.success && data.data && data.data.items && data.data.items.item) {
                    // API 응답 구조가 item이 배열이 아닌 단일 객체로 올 수 있음을 고려
                    return Array.isArray(data.data.items.item) ? data.data.items.item[0] : data.data.items.item;
                } else {
                    console.warn(`No item found or API error for ${contentId} (${lang}):`, data.error?.message || 'Unknown API structure');
                    return null;
                }
            } catch (error) {
                console.error(`Failed to fetch details for contentId ${contentId} (${lang}):`, error);
                return null; // 오류 발생 시 null 반환
            }
        }

        // 관광지 카드 HTML 생성
        function createSpotCard(spotData, lang = 'ko') {
            if (!spotData) {
                const card = document.createElement('div');
                card.className = 'spot-card';
                card.innerHTML = `<div class="spot-card-content"><p>${lang === 'ko' ? '정보를 불러오는데 실패했습니다.' : 'Failed to load information.'}</p></div>`;
                return card;
            }

            const card = document.createElement('div');
            card.className = 'spot-card';

            const title = spotData.title || (lang === 'ko' ? '제목 없음' : 'Untitled');
            const overview = spotData.overview || (lang === 'ko' ? '설명 없음.' : 'No description available.');
            const image = spotData.firstimage || 'https://via.placeholder.com/400x200.png?text=No+Image';
            const address = spotData.addr1 || (lang === 'ko' ? '주소 정보 없음' : 'Address not available');
            const tel = spotData.tel || '';
            let homepage = spotData.homepage || '';

            // 홈페이지 HTML 태그 제거 및 유효성 검사 (클라이언트 측에서도 간단히 처리)
            if (homepage) {
                const tempDiv = document.createElement('div');
                tempDiv.innerHTML = homepage;
                homepage = tempDiv.textContent || tempDiv.innerText || "";
                if (homepage && !homepage.startsWith('http')) {
                    homepage = 'http://' + homepage;
                }
            }


            card.innerHTML = `
                <img src="${image}" alt="${title}" onerror="this.onerror=null;this.src='https.via.placeholder.com/400x200.png?text=Image+Error';">
                <div class="spot-card-content">
                    <h3>${title}</h3>
                    ${address ? `<p class="address">📍 ${address}</p>` : ''}
                    ${tel ? `<p class="tel">📞 ${tel}</p>` : ''}
                    ${homepage ? `<p class="homepage">🌐 <a href="${homepage}" target="_blank" rel="noopener noreferrer">${lang === 'ko' ? '홈페이지 방문' : 'Visit Homepage'}</a></p>` : ''}
                    <p>${overview.substring(0, 150)}${overview.length > 150 ? '...' : ''}</p>
                </div>
            `;
            return card;
        }

        // 관광지 정보 로드 및 표시
        async function loadTouristSpots(lang = 'ko') {
            currentLang = lang;
            spotGrid.innerHTML = ''; // 기존 내용 초기화
            loader.style.display = 'block';

            // 페이지 제목 및 설명 언어 변경
            if (lang === 'ko') {
                pageTitle.textContent = '대한민국 7대 관광지';
                pageDescription.textContent = '한국의 아름다운 7대 관광 명소를 소개합니다. 각 장소의 상세 정보를 확인해보세요.';
                document.documentElement.lang = 'ko';
            } else {
                pageTitle.textContent = 'Top 7 Tourist Destinations in Korea';
                pageDescription.textContent = 'Discover the 7 most beautiful tourist attractions in Korea. Check out the detailed information for each location.';
                document.documentElement.lang = 'en';
            }


            const spotPromises = sevenWondersContentIds.map(spot => fetchSpotDetail(spot.id, lang));

            try {
                const spotDetails = await Promise.all(spotPromises);
                spotDetails.forEach((detail, index) => {
                    // API 호출 실패 시 기본 이름 사용
                    const spotName = detail?.title || (lang === 'ko' ? sevenWondersContentIds[index].nameKo : sevenWondersContentIds[index].nameEn);
                    if (detail) {
                        detail.title = spotName; // API 응답에 title이 없을 경우 대비
                    } else {
                         // API 호출 실패 시, 기본 정보로 카드 생성
                        const placeholderDetail = {
                            title: spotName,
                            overview: lang === 'ko' ? `${spotName}의 상세 정보를 불러오지 못했습니다.` : `Failed to load details for ${spotName}.`,
                            firstimage: 'https.via.placeholder.com/400x200.png?text=Error'
                        };
                         spotGrid.appendChild(createSpotCard(placeholderDetail, lang));
                         return; // 다음 카드로 넘어감
                    }
                    spotGrid.appendChild(createSpotCard(detail, lang));
                });
            } catch (error) {
                console.error("Error loading tourist spots:", error);
                spotGrid.innerHTML = `<p style="color: red; text-align: center;">${lang === 'ko' ? '관광지 정보를 불러오는 중 오류가 발생했습니다.' : 'An error occurred while loading tourist information.'}</p>`;
            } finally {
                loader.style.display = 'none';
            }
        }

        // 페이지 로드 시 기본 언어로 관광지 정보 로드
        window.onload = () => {
            loadTouristSpots(currentLang);
        };
    </script>
</body>
</html>
