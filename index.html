<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ëŒ€í•œë¯¼êµ­ 7ëŒ€ ê´€ê´‘ì§€ ì†Œê°œ</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f7f6;
            color: #333;
            line-height: 1.6;
        }
        header {
            background-color: #2c3e50;
            color: #ecf0f1;
            padding: 20px 0;
            text-align: center;
            border-bottom: 5px solid #3498db;
        }
        header h1 {
            margin: 0;
            font-size: 2.5em;
        }
        nav {
            text-align: center;
            margin: 20px 0;
        }
        nav button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            transition: background-color 0.3s ease;
        }
        nav button:hover {
            background-color: #2980b9;
        }
        .language-switcher {
            text-align: right;
            padding: 10px 20px;
        }
        .language-switcher button {
            background-color: #95a5a6;
            padding: 8px 15px;
            font-size: 0.9em;
        }
        .language-switcher button:hover {
            background-color: #7f8c8d;
        }
        .container {
            width: 90%;
            max-width: 1200px;
            margin: 20px auto;
            padding: 20px;
            background-color: #ffffff;
            box-shadow: 0 0 15px rgba(0,0,0,0.1);
            border-radius: 8px;
        }
        .spot-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        .spot-card {
            border: 1px solid #ddd;
            border-radius: 8px;
            overflow: hidden;
            background-color: #fff;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .spot-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0,0,0,0.1);
        }
        .spot-card img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-bottom: 1px solid #eee;
        }
        .spot-card-content {
            padding: 15px;
        }
        .spot-card h3 {
            margin-top: 0;
            color: #3498db;
            font-size: 1.5em;
        }
        .spot-card p {
            font-size: 0.95em;
            color: #555;
        }
        .spot-card .address {
            font-size: 0.85em;
            color: #777;
            margin-bottom: 10px;
        }
        .spot-card .tel {
            font-size: 0.85em;
            color: #777;
            margin-bottom: 10px;
        }
        .spot-card .homepage a {
            color: #e67e22;
            text-decoration: none;
        }
        .spot-card .homepage a:hover {
            text-decoration: underline;
        }
        .loader {
            text-align: center;
            padding: 50px;
            font-size: 1.5em;
            color: #7f8c8d;
        }
        footer {
            text-align: center;
            padding: 20px;
            margin-top: 30px;
            background-color: #34495e;
            color: #ecf0f1;
            font-size: 0.9em;
        }
    </style>
</head>
<body>

    <header>
        <h1 id="pageTitle">ëŒ€í•œë¯¼êµ­ 7ëŒ€ ê´€ê´‘ì§€</h1>
    </header>

    <div class="language-switcher">
        <button onclick="loadTouristSpots('ko')" id="langKoBtn">ğŸ‡°ğŸ‡· í•œêµ­ì–´</button>
        <button onclick="loadTouristSpots('en')" id="langEnBtn">ğŸ‡¬ğŸ‡§ English</button>
    </div>

    <div class="container">
        <p id="pageDescription" style="text-align: center; font-size: 1.1em; margin-bottom: 30px;">
            í•œêµ­ì˜ ì•„ë¦„ë‹¤ìš´ 7ëŒ€ ê´€ê´‘ ëª…ì†Œë¥¼ ì†Œê°œí•©ë‹ˆë‹¤. ê° ì¥ì†Œì˜ ìƒì„¸ ì •ë³´ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”.
        </p>
        <div id="spotGrid" class="spot-grid">
            <!-- ê´€ê´‘ì§€ ì •ë³´ê°€ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
        </div>
        <div id="loader" class="loader" style="display: none;">
            ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤...
        </div>
    </div>

    <footer>
        <p>&copy; 2025 HealingK Tour Information. All rights reserved.</p>
    </footer>

    <script>
        const API_ENDPOINT = 'https://healingk.vercel.app/api/tourism'; // Vercel ë°°í¬ URL
        const spotGrid = document.getElementById('spotGrid');
        const loader = document.getElementById('loader');
        const pageTitle = document.getElementById('pageTitle');
        const pageDescription = document.getElementById('pageDescription');

        // ì„ì˜ë¡œ ì„ ì •í•œ 7ëŒ€ ê´€ê´‘ì§€ contentId (ì‹¤ì œ ì„œë¹„ìŠ¤ì—ì„œëŠ” ê²€ìƒ‰ ë“±ìœ¼ë¡œ ë™ì  ë¡œë“œ ê¶Œì¥)
        // ìˆœì„œ: ê²½ë³µê¶, ì„êµ´ì•”/ë¶ˆêµ­ì‚¬, í•´ì¸ì‚¬ ì¥ê²½íŒì „, ì°½ë•ê¶, ìˆ˜ì›í™”ì„±, ì œì£¼ í™”ì‚°ì„¬ê³¼ ìš©ì•”ë™êµ´, ë‚¨í•œì‚°ì„± (ìœ ë„¤ìŠ¤ì½” ë“±ì¬ ê¸°ì¤€ ì°¸ê³ )
        const sevenWondersContentIds = [
            { id: '126508', nameKo: "ê²½ë³µê¶", nameEn: "Gyeongbokgung Palace" }, // ê²½ë³µê¶
            { id: '126510', nameKo: "ë¶ˆêµ­ì‚¬", nameEn: "Bulguksa Temple" }, // ë¶ˆêµ­ì‚¬
            { id: '126515', nameKo: "í•´ì¸ì‚¬", nameEn: "Haeinsa Temple" }, // í•´ì¸ì‚¬ (ì¥ê²½íŒì „)
            { id: '126509', nameKo: "ì°½ë•ê¶ê³¼ í›„ì›", nameEn: "Changdeokgung Palace and Huwon" }, // ì°½ë•ê¶
            { id: '126512', nameKo: "ìˆ˜ì›í™”ì„±", nameEn: "Suwon Hwaseong Fortress" }, // ìˆ˜ì›í™”ì„±
            { id: '788049', nameKo: "ì œì£¼ í™”ì‚°ì„¬ê³¼ ìš©ì•”ë™êµ´", nameEn: "Jeju Volcanic Island and Lava Tubes" }, // ì œì£¼ (ì„±ì‚°ì¼ì¶œë´‰ ì˜ˆì‹œ)
            { id: '128119', nameKo: "ë‚¨í•œì‚°ì„±ë„ë¦½ê³µì›", nameEn: "Namhansanseong Provincial Park" }  // ë‚¨í•œì‚°ì„±
        ];

        let currentLang = 'ko'; // ê¸°ë³¸ ì–¸ì–´

        // API í˜¸ì¶œ í•¨ìˆ˜
        async function fetchSpotDetail(contentId, lang = 'ko') {
            const params = new URLSearchParams({
                operation: 'detailCommon', // ìƒì„¸ ì •ë³´ ì¡°íšŒ ì˜¤í¼ë ˆì´ì…˜
                contentId: contentId,
                defaultYN: 'Y',
                firstImageYN: 'Y',
                areacodeYN: 'Y',
                addrinfoYN: 'Y',
                mapinfoYN: 'Y',
                overviewYN: 'Y',
                lang: lang // ì–¸ì–´ íŒŒë¼ë¯¸í„° ì¶”ê°€
            });

            try {
                const response = await fetch(`${API_ENDPOINT}?${params.toString()}`, {
                    method: 'GET',
                    headers: {
                        'Accept-Language': lang // í—¤ë”ì—ë„ ì–¸ì–´ ì„¤ì •
                    }
                });
                if (!response.ok) {
                    const errorData = await response.json();
                    console.error(`Error fetching ${contentId} (${lang}):`, errorData);
                    throw new Error(`HTTP error ${response.status}: ${errorData.error?.message || 'Failed to fetch data'}`);
                }
                const data = await response.json();
                if (data.success && data.data && data.data.items && data.data.items.item) {
                    // API ì‘ë‹µ êµ¬ì¡°ê°€ itemì´ ë°°ì—´ì´ ì•„ë‹Œ ë‹¨ì¼ ê°ì²´ë¡œ ì˜¬ ìˆ˜ ìˆìŒì„ ê³ ë ¤
                    return Array.isArray(data.data.items.item) ? data.data.items.item[0] : data.data.items.item;
                } else {
                    console.warn(`No item found or API error for ${contentId} (${lang}):`, data.error?.message || 'Unknown API structure');
                    return null;
                }
            } catch (error) {
                console.error(`Failed to fetch details for contentId ${contentId} (${lang}):`, error);
                return null; // ì˜¤ë¥˜ ë°œìƒ ì‹œ null ë°˜í™˜
            }
        }

        // ê´€ê´‘ì§€ ì¹´ë“œ HTML ìƒì„±
        function createSpotCard(spotData, lang = 'ko') {
            if (!spotData) {
                const card = document.createElement('div');
                card.className = 'spot-card';
                card.innerHTML = `<div class="spot-card-content"><p>${lang === 'ko' ? 'ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.' : 'Failed to load information.'}</p></div>`;
                return card;
            }

            const card = document.createElement('div');
            card.className = 'spot-card';

            const title = spotData.title || (lang === 'ko' ? 'ì œëª© ì—†ìŒ' : 'Untitled');
            const overview = spotData.overview || (lang === 'ko' ? 'ì„¤ëª… ì—†ìŒ.' : 'No description available.');
            const image = spotData.firstimage || 'https://via.placeholder.com/400x200.png?text=No+Image';
            const address = spotData.addr1 || (lang === 'ko' ? 'ì£¼ì†Œ ì •ë³´ ì—†ìŒ' : 'Address not available');
            const tel = spotData.tel || '';
            let homepage = spotData.homepage || '';

            // í™ˆí˜ì´ì§€ HTML íƒœê·¸ ì œê±° ë° ìœ íš¨ì„± ê²€ì‚¬ (í´ë¼ì´ì–¸íŠ¸ ì¸¡ì—ì„œë„ ê°„ë‹¨íˆ ì²˜ë¦¬)
            if (homepage) {
                const tempDiv = document.createElement('div');
                tempDiv.innerHTML = homepage;
                homepage = tempDiv.textContent || tempDiv.innerText || "";
                if (homepage && !homepage.startsWith('http')) {
                    homepage = 'http://' + homepage;
                }
            }


            card.innerHTML = `
                <img src="${image}" alt="${title}" onerror="this.onerror=null;this.src='https.via.placeholder.com/400x200.png?text=Image+Error';">
                <div class="spot-card-content">
                    <h3>${title}</h3>
                    ${address ? `<p class="address">ğŸ“ ${address}</p>` : ''}
                    ${tel ? `<p class="tel">ğŸ“ ${tel}</p>` : ''}
                    ${homepage ? `<p class="homepage">ğŸŒ <a href="${homepage}" target="_blank" rel="noopener noreferrer">${lang === 'ko' ? 'í™ˆí˜ì´ì§€ ë°©ë¬¸' : 'Visit Homepage'}</a></p>` : ''}
                    <p>${overview.substring(0, 150)}${overview.length > 150 ? '...' : ''}</p>
                </div>
            `;
            return card;
        }

        // ê´€ê´‘ì§€ ì •ë³´ ë¡œë“œ ë° í‘œì‹œ
        async function loadTouristSpots(lang = 'ko') {
            currentLang = lang;
            spotGrid.innerHTML = ''; // ê¸°ì¡´ ë‚´ìš© ì´ˆê¸°í™”
            loader.style.display = 'block';

            // í˜ì´ì§€ ì œëª© ë° ì„¤ëª… ì–¸ì–´ ë³€ê²½
            if (lang === 'ko') {
                pageTitle.textContent = 'ëŒ€í•œë¯¼êµ­ 7ëŒ€ ê´€ê´‘ì§€';
                pageDescription.textContent = 'í•œêµ­ì˜ ì•„ë¦„ë‹¤ìš´ 7ëŒ€ ê´€ê´‘ ëª…ì†Œë¥¼ ì†Œê°œí•©ë‹ˆë‹¤. ê° ì¥ì†Œì˜ ìƒì„¸ ì •ë³´ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”.';
                document.documentElement.lang = 'ko';
            } else {
                pageTitle.textContent = 'Top 7 Tourist Destinations in Korea';
                pageDescription.textContent = 'Discover the 7 most beautiful tourist attractions in Korea. Check out the detailed information for each location.';
                document.documentElement.lang = 'en';
            }


            const spotPromises = sevenWondersContentIds.map(spot => fetchSpotDetail(spot.id, lang));

            try {
                const spotDetails = await Promise.all(spotPromises);
                spotDetails.forEach((detail, index) => {
                    // API í˜¸ì¶œ ì‹¤íŒ¨ ì‹œ ê¸°ë³¸ ì´ë¦„ ì‚¬ìš©
                    const spotName = detail?.title || (lang === 'ko' ? sevenWondersContentIds[index].nameKo : sevenWondersContentIds[index].nameEn);
                    if (detail) {
                        detail.title = spotName; // API ì‘ë‹µì— titleì´ ì—†ì„ ê²½ìš° ëŒ€ë¹„
                    } else {
                         // API í˜¸ì¶œ ì‹¤íŒ¨ ì‹œ, ê¸°ë³¸ ì •ë³´ë¡œ ì¹´ë“œ ìƒì„±
                        const placeholderDetail = {
                            title: spotName,
                            overview: lang === 'ko' ? `${spotName}ì˜ ìƒì„¸ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.` : `Failed to load details for ${spotName}.`,
                            firstimage: 'https.via.placeholder.com/400x200.png?text=Error'
                        };
                         spotGrid.appendChild(createSpotCard(placeholderDetail, lang));
                         return; // ë‹¤ìŒ ì¹´ë“œë¡œ ë„˜ì–´ê°
                    }
                    spotGrid.appendChild(createSpotCard(detail, lang));
                });
            } catch (error) {
                console.error("Error loading tourist spots:", error);
                spotGrid.innerHTML = `<p style="color: red; text-align: center;">${lang === 'ko' ? 'ê´€ê´‘ì§€ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.' : 'An error occurred while loading tourist information.'}</p>`;
            } finally {
                loader.style.display = 'none';
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ê¸°ë³¸ ì–¸ì–´ë¡œ ê´€ê´‘ì§€ ì •ë³´ ë¡œë“œ
        window.onload = () => {
            loadTouristSpots(currentLang);
        };
    </script>
</body>
</html>
